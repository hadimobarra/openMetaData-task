/*! For license information please see 2808.c9849e977305b6c568a1.js.LICENSE.txt */
(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[2808],{56334:function(e,t,n){"use strict";var a=n(8081),r=n.n(a),o=n(23645),i=n.n(o)()(r());i.push([e.id,'/*\n *  Copyright 2021 Collate\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.kpi-slider .ant-slider-track {\n  background: #54C5D0;\n}\n',""]),t.Z=i},20514:function(e,t,n){"use strict";n.d(t,{T:function(){return u}});var a=n(67294),r=n(11411),o=n.n(r),i=n(79896);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}function u(e){var t=e.children,n=e.width,r=e.height,u=e.viewBox,s=e.className,c=e.style,p=function(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,["children","width","height","viewBox","className","style"]),d=u||{width:n,height:r,x:0,y:0},m=o()("recharts-surface",s);return a.createElement("svg",l({},(0,i.L6)(p,!0,!0),{className:m,width:n,height:r,style:c,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height),version:"1.1"}),t)}},79896:function(e,t,n){"use strict";n.d(t,{L6:function(){return c},Ym:function(){return p},bw:function(){return d}});var a=n(13218),r=n.n(a),o=n(67294);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var l=["viewBox","children"],u=["className","color","height","id","lang","max","media","method","min","name","style","target","type","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","points","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],s=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],c=function(e,t,n){if(!e||"function"==typeof e||"boolean"==typeof e)return null;var a=e;if((0,o.isValidElement)(e)&&(a=e.props),!r()(a))return null;var i={};return Object.keys(a).forEach((function(e){(u.includes(e)||n&&l.includes(e)||t&&s.includes(e))&&(i[e]=a[e])})),i},p=function(e,t){if(!e||"function"==typeof e||"boolean"==typeof e)return null;var n=e;if((0,o.isValidElement)(e)&&(n=e.props),!r()(n))return null;var a={};return Object.keys(n).forEach((function(e){s.includes(e)&&(a[e]=t||function(t){return n[e](n,t)})})),a},d=function(e,t,n){if(!r()(e)||"object"!==i(e))return null;var a=null;return Object.keys(e).forEach((function(r){var o=e[r];s.includes(r)&&"function"==typeof o&&(a||(a={}),a[r]=function(e,t,n){return function(a){return e(t,n,a),null}}(o,t,n))})),a}},11411:function(e,t){var n;!function(){"use strict";var a={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var i=r.apply(null,n);i&&e.push(i)}}else if("object"===o){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var l in n)a.call(n,l)&&n[l]&&e.push(l)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},60668:function(e,t,n){"use strict";var a=n(93379),r=n.n(a),o=n(7795),i=n.n(o),l=n(90569),u=n.n(l),s=n(3565),c=n.n(s),p=n(19216),d=n.n(p),m=n(44589),f=n.n(m),h=n(56334),g={};g.styleTagTransform=f(),g.setAttributes=c(),g.insert=u().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=d(),r()(h.Z,g),h.Z&&h.Z.locals&&h.Z.locals},75561:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var a,r=n(70655),o=n(71230),i=n(15746),l=n(91894),u=n(56256),s=n(9242),c=n(4107),p=n(99177),d=n(85986),m=n(23592),f=n(19650),h=n(71577),g=n(94199),C=n(96486),y=n(67294),v=n(437),b=n(59293),E=n(97809),k=n(84419),S=(n(60668),n(60236)),D=n(30381),x=n.n(D),P=n(87272),T=n(96364),w=n(28178),O=n(53867),Z=n(62761),I=n(60625);!function(e){e.Number="NUMBER",e.Percentage="PERCENTAGE"}(a||(a={}));var A=n(85087),N=n(83531),L=n(36096),M=n(87968),R=n(50168),U=function(){var e=(0,A.a)().isAdminUser,t=(0,b.UO)().kpiName,n=(0,v.$)().t,D=(0,b.k6)(),U=(0,r.CR)((0,y.useState)(),2),j=U[0],B=U[1],V=(0,r.CR)((0,y.useState)(!1),2),q=V[0],H=V[1],F=(0,r.CR)((0,y.useState)(""),2),W=F[0],K=F[1],z=(0,r.CR)((0,y.useState)(),2),Y=z[0],_=z[1],G=(0,r.CR)((0,y.useState)(0),2),X=G[0],J=G[1],$=(0,r.CR)((0,y.useState)(!1),2),Q=$[0],ee=$[1],te=(0,r.CR)((0,y.useState)(I.cA),2),ne=te[0],ae=te[1],re=(0,y.useMemo)((function(){var e;return[{name:n("label.data-insight"),url:Z.Z6.DATA_INSIGHT},{name:n("label.kpi-list"),url:Z.Z6.KPI_LIST},{name:null!==(e=null==j?void 0:j.name)&&void 0!==e?e:"",url:"",activeTitle:!0}]}),[j]),oe=(0,y.useMemo)((function(){if(j)return j.targetDefinition[0]}),[j]),ie=(0,y.useMemo)((function(){if(j){var e=j.targetDefinition[0],t=j.dataInsightChart,n=x()(j.startDate),a=x()(j.endDate);return{name:j.name,displayName:j.displayName,dataInsightChart:t.displayName||t.name,metricType:e.name,startDate:n,endDate:a}}return{}}),[j]),le=function(e,t){ae((function(n){var a;return(0,r.pi)((0,r.pi)({},n),((a={})[t]=e,a))}))};return(0,y.useEffect)((function(){(0,r.mG)(void 0,void 0,void 0,(function(){var e,n;return(0,r.Jh)(this,(function(a){switch(a.label){case 0:H(!0),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,(0,T._q)(t,{fields:"startDate,endDate,targetDefinition,dataInsightChart,metricType"})];case 2:return e=a.sent(),B(e),[3,5];case 3:return n=a.sent(),(0,R.Eo)(n),[3,5];case 4:return H(!1),[7];case 5:return[2]}}))}))}),[t]),(0,y.useEffect)((function(){if(j){var e=(0,L.xm)(j.startDate),t=(0,L.xm)(j.endDate);(0,r.mG)(void 0,void 0,void 0,(function(){var e,t,n;return(0,r.Jh)(this,(function(a){switch(a.label){case 0:if(!(e=null==j?void 0:j.dataInsightChart.id))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(0,P.$w)(e)];case 2:return t=a.sent(),_(t),[3,4];case 3:return n=a.sent(),(0,R.Eo)(n),[3,4];case 4:return[2]}}))})),K(j.description),ae({startDate:e,endDate:t})}}),[j]),(0,y.useEffect)((function(){var e,t=(0,C.toNumber)(null!==(e=null==oe?void 0:oe.value)&&void 0!==e?e:"0"),n=(null==j?void 0:j.metricType)===a.Percentage?100*t:t;J((0,C.toInteger)(n))}),[oe,j]),q?y.createElement(O.Z,null):y.createElement(y.Fragment,null,j?y.createElement(o.Z,{className:"bg-body-main h-full","data-testid":"edit-kpi-container",gutter:[16,16]},y.createElement(i.Z,{offset:4,span:12},y.createElement(k.Z,{className:"my-4",titleLinks:re}),y.createElement(l.Z,null,y.createElement(u.Z.Paragraph,{className:"text-base","data-testid":"form-title"},n("label.edit-entity",{entity:n("label.kpi-uppercase")})),y.createElement(s.Z,{"data-testid":"kpi-form",id:"kpi-form",initialValues:ie,layout:"vertical",validateMessages:I.lw,onFinish:function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){var t,n,a,o,i,l,u,s;return(0,r.Jh)(this,(function(c){switch(c.label){case 0:if(!j||!oe)return[3,5];t=(0,L.ET)(ne),n=(0,M.ul)(t.startDate),a=(0,M.ul)(t.endDate),o=(0,L.cW)(j.metricType,X),i=(0,r.pi)((0,r.pi)({},j),{description:W,displayName:e.displayName,endDate:a,startDate:n,targetDefinition:[(0,r.pi)((0,r.pi)({},oe),{value:o+""})]}),l=(0,S.qu)(j,i),ee(!0),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,(0,T.pH)(null!==(s=j.id)&&void 0!==s?s:"",l)];case 2:return c.sent(),D.push(Z.Z6.KPI_LIST),[3,5];case 3:return u=c.sent(),(0,R.Eo)(u),[3,5];case 4:return ee(!1),[7];case 5:return[2]}}))}))}},y.createElement(s.Z.Item,{label:n("label.data-insight-chart"),name:"dataInsightChart"},y.createElement(c.Z,{disabled:!0,"data-testid":"dataInsightChart",value:(null==Y?void 0:Y.displayName)||(null==Y?void 0:Y.name)})),y.createElement(s.Z.Item,{label:n("label.display-name"),name:"displayName"},y.createElement(c.Z,{"data-testid":"displayName",placeholder:n("label.kpi-display-name"),type:"text"})),y.createElement(s.Z.Item,{label:n("label.metric-type"),name:"metricType"},y.createElement(c.Z,{disabled:!0,"data-testid":"metricType",value:null==oe?void 0:oe.name})),!(0,C.isUndefined)(oe)&&y.createElement(s.Z.Item,{label:n("label.metric-value"),name:"metricValue",rules:[{required:!0,validator:function(){return X>=0?Promise.resolve():Promise.reject(n("message.metric-value-required"))}}]},y.createElement(y.Fragment,null,(null==j?void 0:j.metricType)===a.Percentage&&y.createElement(o.Z,{"data-testid":"metric-percentage-input",gutter:20},y.createElement(i.Z,{span:20},y.createElement(p.Z,{className:"kpi-slider",marks:{0:"0%",100:"100%"},max:100,min:0,tooltipPlacement:"bottom",tooltipVisible:!1,value:X,onChange:function(e){J(e)}})),y.createElement(i.Z,{span:4},y.createElement(d.Z,{formatter:function(e){return e+"%"},max:100,min:0,step:1,value:X,onChange:function(e){J(Number(e))}}))),(null==j?void 0:j.metricType)===a.Number&&y.createElement(d.Z,{className:"w-full","data-testid":"metric-number-input",min:0,value:X,onChange:function(e){return J(Number(e))}}))),y.createElement(o.Z,{gutter:[8,8]},y.createElement(i.Z,{span:12},y.createElement(s.Z.Item,{label:n("label.start-date"),messageVariables:{fieldName:"startDate"},name:"startDate",rules:[{required:!0,message:n("label.field-required",{field:n("label.start-date")})}]},y.createElement(m.Z,{className:"w-full","data-testid":"start-date",disabledDate:L.nu,format:I.aJ,onChange:function(e,t){return le(t,N.O.START_DATE)}}))),y.createElement(i.Z,{span:12},y.createElement(s.Z.Item,{label:n("label.end-date"),messageVariables:{fieldName:"endDate"},name:"endDate",rules:[{required:!0,message:n("label.field-required",{field:n("label.end-date")})}]},y.createElement(m.Z,{className:"w-full","data-testid":"end-date",disabledDate:L.nu,format:I.aJ,onChange:function(e,t){return le(t,N.O.END_DATE)}})))),y.createElement(s.Z.Item,{label:n("label.description"),name:"description"},y.createElement(E.Z,{height:"200px",initialValue:W,placeHolder:n("label.write-your-description"),style:{margin:0},onTextChange:function(e){return K(e)}})),y.createElement(f.Z,{align:"center",className:"w-full justify-end"},y.createElement(h.Z,{"data-testid":"cancel-btn",type:"link",onClick:function(){return D.goBack()}},n("label.go-back")),y.createElement(g.Z,{title:n(e?"label.save":"message.no-permission-for-action")},y.createElement(h.Z,{"data-testid":"submit-btn",disabled:!e,form:"kpi-form",htmlType:"submit",loading:Q,type:"primary"},n("label.save"))))))),y.createElement(i.Z,{className:"m-t-md","data-testid":"right-panel",span:4},y.createElement(u.Z.Paragraph,{className:"text-base font-medium"},n("label.edit-entity",{entity:n("label.kpi-uppercase")})),y.createElement(u.Z.Text,null,n("message.add-kpi-message")))):y.createElement(w.Z,null,n("message.no-kpi-found",{name:t})))}}}]);