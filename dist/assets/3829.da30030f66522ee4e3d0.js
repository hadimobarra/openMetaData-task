"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[3829],{41912:function(e,t,n){n.d(t,{Cp:function(){return s},o6:function(){return o},SI:function(){return l},qf:function(){return c},M_:function(){return u},Tf:function(){return d}});var a=n(70655),i=n(22334),r=n(97451),s=function(e,t,n){return(0,a.mG)(void 0,void 0,void 0,(function(){var s;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return s=(0,i.JP)("/databases",t)+"&service="+e+(n||""),[4,r.Z.get(s)];case 1:return[2,a.sent().data]}}))}))},o=function(e,t){return(0,a.mG)(void 0,void 0,void 0,(function(){var n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return n=(0,i.JP)("/databases/name/"+e,t),[4,r.Z.get(n)];case 1:return[2,a.sent().data]}}))}))},l=function(e,t){return(0,a.mG)(void 0,void 0,void 0,(function(){var n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return n={headers:{"Content-type":"application/json-patch+json"}},[4,r.Z.patch("/databases/"+e,t,n)];case 1:return[2,a.sent().data]}}))}))},c=function(e,t){return(0,a.mG)(void 0,void 0,void 0,(function(){var n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return n={headers:{"Content-type":"application/json-patch+json"}},[4,r.Z.patch("/databaseSchemas/"+e,t,n)];case 1:return[2,a.sent().data]}}))}))},u=function(e,t,n){return(0,a.mG)(void 0,void 0,void 0,(function(){var s;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return s=(0,i.JP)("/databaseSchemas",n)+"&database="+e+(t||""),[4,r.Z.get(s)];case 1:return[2,a.sent().data]}}))}))},d=function(e,t){return(0,a.mG)(void 0,void 0,void 0,(function(){var n;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return n=""+(0,i.JP)("/databaseSchemas/name/"+e,t),[4,r.Z.get(n)];case 1:return[2,a.sent().data]}}))}))}},6603:function(e,t,n){var a=n(70655),i=n(4107),r=n(94184),s=n.n(r),o=n(96486),l=n(45697),c=n.n(l),u=n(67294),d=n(38464),m=n(53867),f=function(e){var t=e.onSearch,n=e.searchValue,r=e.typingInterval,l=void 0===r?0:r,c=e.placeholder,f=e.label,p=e.removeMargin,g=void 0!==p&&p,E=e.showLoadingStatus,v=void 0!==E&&E,w=(0,a.CR)((0,u.useState)(""),2),h=w[0],b=w[1],y=(0,a.CR)((0,u.useState)(d.PJ.SEARCHV1),2),S=y[0],C=y[1],Z=(0,a.CR)((0,u.useState)("initial"),2),I=Z[0],R=Z[1];(0,u.useEffect)((function(){b(n)}),[n]);var A=(0,u.useCallback)((function(e){R((function(e){return"waiting"===e?"success":e})),t(e)}),[t]),k=(0,u.useCallback)((0,o.debounce)(A,l),[A]);return u.createElement("div",{className:s()("tw-group page-search-bar",{"tw-mb-4":!g}),"data-testid":"search-bar-container"},""!==f&&u.createElement("label",null,f),u.createElement("div",{className:"flex relative"},u.createElement(i.Z,{"data-testid":"searchbar",placeholder:c,prefix:u.createElement(d.ZP,{alt:"icon-search",className:"tw-w-4 tw-h-4 tw-mr-0.5",icon:S}),type:"text",value:h,onBlur:function(){return C(d.PJ.SEARCHV1)},onChange:function(e){var t=e.target.value;b(t),R((function(e){return"waiting"!==e?"waiting":e})),k(t)},onFocus:function(){return C(d.PJ.SEARCHV1COLOR)}}),v&&"waiting"===I&&u.createElement("div",{className:"tw-absolute tw-block tw-z-1 tw-w-4 tw-h-4 tw-top-2 tw-right-2.5 tw-text-center tw-pointer-events-none"},u.createElement(m.Z,{size:"small",type:"default"}))))};f.defaultProps={searchValue:"",typingInterval:1e3,placeholder:"Search...",label:""},f.propTypes={onSearch:c().func.isRequired,searchValue:c().string,typingInterval:c().number,placeholder:c().string,label:c().string},t.Z=f},78666:function(e,t,n){n.d(t,{V1:function(){return i},vm:function(){return r},IL:function(){return s},Rw:function(){return o},Pm:function(){return l}});var a=n(67800),i=[{name:a.ZP.t("label.configure-entity",{entity:a.ZP.t("label.ingestion")}),step:1},{name:a.ZP.t("label.configure-entity",{entity:a.ZP.t("label.dbt-lowercase")}),step:2},{name:a.ZP.t("label.configure-metadata-to-es-config-optional"),step:3},{name:a.ZP.t("label.schedule-interval"),step:4}],r={includes:[],excludes:[]},s=[{name:a.ZP.t("label.select-service-type"),step:1},{name:a.ZP.t("label.configure-entity",{entity:a.ZP.t("label.service")}),step:2},{name:a.ZP.t("label.connection-details"),step:3}],o={ADD:"add",EDIT:"edit"},l={dataInsight:"data-insight",dbt:"dbt",elasticSearchReindex:"elastic-search-re-index",lineage:"lineage",metadata:"metadata",profiler:"profiler",TestSuite:"test-suite",usage:"usage"}},92693:function(e,t,n){n.d(t,{dF:function(){return a},cK:function(){return i},lS:function(){return r},tf:function(){return s},Kb:function(){return o},E6:function(){return l},y9:function(){return c},BM:function(){return u},ck:function(){return d},_F:function(){return m}});var a="/about-us",i="/about-us",r="/about-us",s="/about-us",o="/about-us",l="/about-us",c="/about-us",u="/about-us",d="/about-us",m="/about-us"},67658:function(e,t,n){var a,i,r,s;n.d(t,{G5:function(){return r}}),function(e){e.Auth0="auth0",e.Azure="azure",e.CustomOidc="custom-oidc",e.Google="google",e.NoAuth="no-auth",e.Okta="okta",e.Openmetadata="openmetadata"}(a||(a={})),function(e){e.Aws="aws",e.AwsSsm="aws-ssm",e.InMemory="in-memory",e.ManagedAws="managed-aws",e.ManagedAwsSsm="managed-aws-ssm",e.Noop="noop"}(i||(i={})),function(e){e.Amundsen="Amundsen",e.Atlas="Atlas",e.MetadataES="MetadataES",e.OpenMetadata="OpenMetadata"}(r||(r={})),function(e){e.Ignore="ignore",e.NoSSL="no-ssl",e.Validate="validate"}(s||(s={}))},93829:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ne}});var a=n(70655),i=n(19650),r=n(56256),s=n(71230),o=n(15746),l=n(94199),c=n(71577),u=n(2307),d=n(67800),m=n(96486),f=n(67294),p=n(97882),g=n(59293),E=n(71560),v=n(41912),w=n(32822),h=n(74313),b=n(85947),y=n(14480),S=n(22503),C=n(41989),Z=n(10584),I=n(72945),R=n(9632),A=n(4142),k=n(28178),N=n(89946),P=n(41693),V=n(25577),x=n(80131),D=n(8851),T=n(84419),O=n(74380),_=n(51436),M=n(67814),z=n(25213),L=n(94184),H=n.n(L),G=n(92458),B=n.n(G),J=n(437),j=n(62761),F=n(92693),U=n(78666),Q=n(67658),W=n(5302),q=n(48132),K=n(96840),$=n(77743),X=n(38464),Y=n(50168),ee=n(95597),te=n(6603),ne=n(95126),ae=n(53867),ie=n(50922),re=n(35741),se=n(93389),oe=n(79839),le=n(29695),ce=function(e){var t=e.airflowEndpoint,n=e.serviceName,i=e.serviceCategory,s=e.serviceDetails,o=e.ingestionList,u=e.isRequiredDetailsAvailable,d=e.deleteIngestion,p=e.triggerIngestion,E=e.deployIngestion,v=e.paging,w=e.pagingHandler,h=e.handleEnableDisableIngestion,b=e.currrentPage,y=e.onIngestionWorkflowsUpdate,S=e.permissions,C=(0,g.k6)(),Z=(0,J.$)().t,I=(0,se.BL)().getEntityPermissionByFqn,R=(0,a.CR)((0,f.useState)(""),2),A=R[0],N=R[1],V=(0,a.CR)((0,f.useState)(!1),2),x=V[0],D=V[1],T=(0,a.CR)((0,f.useState)({id:"",state:""}),2),O=T[0],L=T[1],G=(0,a.CR)((0,f.useState)({id:"",state:""}),2),ce=G[0],ue=G[1],de=(0,a.CR)((0,f.useState)(!1),2),me=de[0],fe=de[1],pe=(0,a.CR)((0,f.useState)(),2),ge=pe[0],Ee=pe[1],ve=(0,a.CR)((0,f.useState)({id:"",name:"",state:""}),2),we=ve[0],he=ve[1],be=(0,a.CR)((0,f.useState)(!1),2),ye=be[0],Se=be[1],Ce=(0,f.useMemo)((function(){var e,t;return(null===(t=null===(e=s.connection)||void 0===e?void 0:e.config)||void 0===t?void 0:t.type)===Q.G5.OpenMetadata}),[s]),Ze=(0,a.CR)((0,f.useState)(o),2),Ie=Ze[0],Re=Ze[1],Ae=(0,a.CR)((0,f.useState)(),2),ke=Ae[0],Ne=Ae[1],Pe=function(e){var t;return!(null===(t=null==ke?void 0:ke[e])||void 0===t?void 0:t.EditAll)},Ve=function(e){ue({id:e,state:"waiting"}),E(e).then((function(){ue({id:e,state:"success"}),setTimeout((function(){return ue({id:"",state:""})}),1500)})).catch((function(){return ue({id:"",state:""})}))},xe=function(){fe(!1),he({id:"",name:"",state:""})},De=function(e){C.push((0,K.fO)(i,n,e.fullyQualifiedName||n+"."+e.name,e.pipelineType))},Te=function(e,t){he({id:e,name:t,state:""}),fe(!0)},Oe=function(e){D(!1),e&&C.push((0,K.sT)(i,n,e))},_e=(0,f.useMemo)((function(){return Ie.some((function(e){return e.pipelineType===W.Hz.DataInsight}))}),[Ie]),Me=function(e){var t;switch(e){case W.Hz.ElasticSearchReindex:t=Z("label.add-entity",{entity:Z("label.elastic-search-re-index")});break;case W.Hz.Dbt:t=Z("label.add-workflow-ingestion",{workflow:Z("label.dbt-lowercase")});break;default:t=Z("label.add-workflow-ingestion",{workflow:Z("label."+U.Pm[e])})}return t};(0,f.useEffect)((function(){var e;e=(0,m.lowerCase)(A),Re(e?o.filter((function(t){return(0,m.lowerCase)(t.displayName).includes(e)||(0,m.lowerCase)(t.name).includes(e)})):o)}),[A,o]),(0,f.useEffect)((function(){(0,a.mG)(void 0,void 0,void 0,(function(){var e,t,n,i;return(0,a.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=o.map((function(e){return I(oe.A.INGESTION_PIPELINE,e.name)})),[4,Promise.allSettled(e)];case 1:return t=r.sent(),n=t.reduce((function(e,t,n){var i;return(0,a.pi)((0,a.pi)({},e),((i={})[null==o?void 0:o[n].name]="fulfilled"===t.status?t.value:{},i))}),{}),Ne(n),[3,3];case 2:return i=r.sent(),(0,Y.Eo)(i),[3,3];case 3:return[2]}}))}))}),[]);var ze,Le,He,Ge,Be,Je=f.createElement("span",{className:"tw-inline-block tw-text-gray-400 tw-self-center"},"|"),je=function(e){return e.deployed?f.createElement(f.Fragment,null,f.createElement(c.Z,{"data-testid":"run",type:"link",onClick:function(){return t=e.id,n=e.name,L({id:t,state:"waiting"}),void p(t,n).then((function(){L({id:t,state:"success"}),setTimeout((function(){L({id:"",state:""}),(0,Y.XA)(Z("message.pipeline-trigger-success-message"))}),1500)})).catch((function(){return L({id:"",state:""})}));var t,n}},(0,q.vc)(O,e.id,Z("label.run"))),Je,f.createElement(c.Z,{"data-testid":"re-deploy-btn",disabled:!u||Pe(e.name),type:"link",onClick:function(){return Ve(e.id)}},(0,q.vc)(ce,e.id,Z("label.re-deploy")))):f.createElement(c.Z,{"data-testid":"deploy",disabled:!u||Pe(e.name),type:"link",onClick:function(){return Ve(e.id)}},(0,q.vc)(ce,e.id,Z("label.deploy")))},Fe=(0,f.useMemo)((function(){return[{title:Z("label.name"),dataIndex:"name",key:"name",render:function(e){return t?f.createElement(l.Z,{title:S.ViewAll||S.ViewBasic?Z("label.view-dag"):Z("message.no-permission-to-view")},f.createElement(c.Z,{className:"tw-mr-2","data-testid":"airflow-tree-view",disabled:!(S.ViewAll||S.ViewBasic),href:t+"/tree?dag_id="+e,rel:"noopener noreferrer",target:"_blank",type:"link"},e,f.createElement(X.ZP,{alt:"external-link",className:"tw-align-middle tw-ml-1",icon:X.PJ.EXTERNAL_LINK,width:"16px"}))):e}},{title:Z("label.type"),dataIndex:"pipelineType",key:"pipelineType"},{title:Z("label.schedule"),dataIndex:"schedule",key:"schedule",render:function(e,t){var n,a;return(null===(n=t.airflowConfig)||void 0===n?void 0:n.scheduleInterval)?f.createElement(ee.Z,{html:f.createElement("div",null,B().toString(t.airflowConfig.scheduleInterval||"",{use24HourTimeFormat:!0,verbose:!0})),position:"bottom",theme:"light",trigger:"mouseenter"},f.createElement("span",null,null!==(a=t.airflowConfig.scheduleInterval)&&void 0!==a?a:"--")):f.createElement("span",null,"--")}},{title:Z("label.recent-runs"),dataIndex:"recentRuns",key:"recentRuns",width:180,render:function(e,t){return f.createElement(le.K,{classNames:"align-middle",ingestion:t})}},{title:Z("label.actions"),dataIndex:"actions",key:"actions",render:function(e,t){var n,a;return f.createElement("div",null,f.createElement("div",{className:"tw-flex"},t.enabled?f.createElement(f.Fragment,null,je(t),Je,f.createElement(c.Z,{"data-testid":"pause",disabled:!u||Pe(t.name),type:"link",onClick:function(){return h(t.id||"")}},Z("label.pause"))):f.createElement(c.Z,{"data-testid":"unpause",disabled:!u||Pe(t.name),type:"link",onClick:function(){return h(t.id||"")}},Z("label.unpause")),Je,f.createElement(c.Z,{"data-testid":"edit",disabled:!u||Pe(t.name),type:"link",onClick:function(){return De(t)}},Z("label.edit")),Je,f.createElement(c.Z,{"data-testid":"delete",disabled:!(null===(n=null==ke?void 0:ke[t.name])||void 0===n?void 0:n.Delete),type:"link",onClick:function(){return Te(t.id,t.name)}},we.id===t.id?"success"===we.state?f.createElement(M.G,{icon:"check"}):f.createElement(ae.Z,{size:"small",type:"default"}):Z("label.delete")),Je,f.createElement(c.Z,{"data-testid":"kill",disabled:!u,type:"link",onClick:function(){Se(!0),Ee(t)}},Z("label.kill")),Je,f.createElement(c.Z,{"data-testid":"logs",disabled:!u,href:(0,K.Ht)(i,(null===(a=t.service)||void 0===a?void 0:a.name)||"",(null==t?void 0:t.fullyQualifiedName)||(null==t?void 0:t.name)||""),type:"link",onClick:function(){Ee(t)}},Z("label.logs"))),ye&&ge&&t.id===(null==ge?void 0:ge.id)&&f.createElement(re.Z,{isModalOpen:ye,pipelinName:ge.name,pipelineId:ge.id,onClose:function(){Se(!1),Ee(void 0)},onIngestionWorkflowsUpdate:y}))}}]}),[S,t,je,u,h,Te,De,we,Se,Ee,K.Ht,i,ye,ge,y]);return f.createElement("div",{"data-testid":"ingestion-container"},f.createElement("div",{className:"mt-4","data-testid":"ingestion-details-container"},f.createElement("div",{className:"d-flex"},!u&&f.createElement("div",{className:"tw-rounded tw-bg-error-lite tw-text-error tw-font-medium tw-px-4 tw-py-1 tw-mb-4 tw-flex tw-items-center tw-gap-1"},f.createElement(M.G,{icon:_.RLE}),f.createElement("p",null,Z("message.no-service-connection-details-message",{serviceName:n})))),f.createElement("div",{className:"tw-flex tw-justify-between"},f.createElement("div",{className:"tw-w-4/12"},A||!(0,m.isEmpty)(Ie)?f.createElement(te.Z,{placeholder:Z("message.search-for-ingestion")+"...",searchValue:A,typingInterval:500,onSearch:function(e){N(e)}}):null),f.createElement("div",{className:"tw-relative"},u&&S.EditAll&&(Le=function(){var e,t=[],n=null===(e=s.connection)||void 0===e?void 0:e.config;return n?(n.supportsMetadataExtraction&&t.push(W.Hz.Metadata),n.supportsUsageExtraction&&t.push(W.Hz.Usage),n.supportsUsageExtraction&&t.push(W.Hz.Lineage),n.supportsProfiler&&t.push(W.Hz.Profiler),n.supportsDBTExtraction&&t.push(W.Hz.Dbt),n.supportsDataInsightExtraction&&t.push(W.Hz.DataInsight),n.supportsElasticSearchReindexingExtraction&&t.push(W.Hz.ElasticSearchReindex)):t=[W.Hz.Metadata,W.Hz.Usage,W.Hz.Lineage,W.Hz.Profiler,W.Hz.Dbt],t}(),He=Ce||o.length>0?Le.reduce((function(e,t){return t===W.Hz.Usage&&o.find((function(e){return e.pipelineType===t}))?e:(0,a.ev)((0,a.ev)([],(0,a.CR)(e)),[t])}),[]):[W.Hz.Metadata,W.Hz.Usage,W.Hz.Lineage,W.Hz.Profiler,W.Hz.Dbt],Ge=null,Be=o.find((function(e){return e.pipelineType===W.Hz.Metadata})),He.length&&(Ce||Be?Ge=function(e){return f.createElement(f.Fragment,null,f.createElement(c.Z,{className:H()("h-8 rounded-4 m-b-xs flex items-center"),"data-testid":"add-new-ingestion-button",disabled:!S.Create,size:"small",type:"primary",onClick:function(){return D((function(e){return!e}))}},Z("label.add-pipeline-ingestion",{pipelineType:""}),x?f.createElement($.Ym,{style:{transform:"rotate(180deg)",verticalAlign:"middle",color:"#fff"}}):f.createElement($.Ym,{style:{color:"#fff",verticalAlign:"middle"}})),x&&f.createElement(ne.Z,{horzPosRight:!0,dropDownList:e.map((function(e){return{name:Me(e),disabled:e===W.Hz.DataInsight&&_e,value:e}})),onSelect:function(e,t){return Oe(t)}}))}(He):(ze=W.Hz.Metadata,Ge=f.createElement(c.Z,{className:H()("h-8 rounded-4 m-b-xs"),"data-testid":"add-new-ingestion-button",size:"small",type:"primary",onClick:function(){return Oe(ze)}},Z("label.add-pipeline-ingestion",{pipelineType:(0,m.startCase)(ze)})))),Ge))),(0,m.isEmpty)(Ie)?u&&0===o.length&&f.createElement(k.Z,null,f.createElement(r.Z.Text,null,Z("message.no-ingestion-available")),f.createElement(r.Z.Text,null,Z("message.no-ingestion-description")),f.createElement(r.Z.Link,{href:F.tf,target:"_blank"},Z("label.metadata-ingestion"))):f.createElement("div",{className:"tw-mb-6","data-testid":"ingestion-table"},f.createElement(z.Z,{bordered:!0,className:"table-shadow",columns:Fe,"data-testid":"schema-table",dataSource:Ie,pagination:!1,rowKey:"name",size:"small"}),Boolean(!(0,m.isNil)(v.after)||!(0,m.isNil)(v.before))&&f.createElement(P.Z,{currentPage:b,pageSize:j.IV,paging:v,pagingHandler:w,totalCount:v.total}))),f.createElement(ie.Z,{entityName:we.name,entityType:Z("label.ingestion-lowercase"),loadingState:we.state,visible:me,onCancel:xe,onConfirm:function(){return e=we.id,t=we.name,he({id:e,name:t,state:"waiting"}),void d(e,t).then((function(){setTimeout((function(){he({id:e,name:t,state:"success"}),xe()}),500)})).catch((function(){xe()}));var e,t}}))},ue=n(22132),de=n(64632),me=n(65131),fe=n(31487),pe=n(41642),ge=n(11384),Ee=n(81706),ve=n(79469),we=function(e){var t=e.connectionDetails,n=e.serviceCategory,i=e.serviceFQN,r=(0,a.CR)((0,f.useState)({}),2),s=r[0],o=r[1],l=(0,a.CR)((0,f.useState)(),2),c=l[0],u=l[1],d=function(e,t){return Object.keys(e).map((function(i){var r,o,l=e[i];if(!(0,m.isObject)(l)){if(i in ue.lR||(0,m.isNull)(l))return null;var c=t[i]?t[i]:{},u=c.description,p=c.format,g=c.title;return f.createElement("div",{className:"tw-w-1/2 tw-flex tw-nowrap tw-mb-3",key:i},f.createElement("div",{className:"tw-flex"},f.createElement("p",{className:"tw-text-gray-500 tw-m-0"},g||i,":"),f.createElement(ee.Z,{delay:0,position:"bottom",title:u,trigger:"mouseenter"},f.createElement(M.G,{className:"tw-mx-1",color:"#C4C4C4",icon:(0,a.pi)({},_.sqG)}))),f.createElement("div",{className:"tw-mx-3 tw-flex-1"},f.createElement("input",{readOnly:!0,className:"tw-w-full tw-outline-none",type:"password"!==p?"text":"password",value:l})))}if(n.slice(0,-1)===de.py.PIPELINE_SERVICE&&"connection"===i){var E=t[i].oneOf.filter((function(e){return e.title===l.type+"Connection"}))[0].properties;return d(l,E)}if(n.slice(0,-1)===de.py.DATABASE_SERVICE&&"credentials"===i)return(0,m.isObject)(l.gcsConfig)?(E=t[i].definitions.GCSValues.properties,d(l.gcsConfig,E)):(E=t[i].definitions.GCSCredentialsPath,d(l,E));if(n.slice(0,-1)!==de.py.DATABASE_SERVICE||"configSource"!==i)return n.slice(0,-1)===de.py.METADATA_SERVICE&&"securityConfig"===i?(E=t[i].oneOf.filter((function(e){return e.title===ue.mf}))[0].properties,d(l,E)):d(l,t[i]&&t[i].properties?t[i].properties:{});if((0,m.isObject)(l.securityConfig)){if(l.securityConfig.gcsConfig){if((0,m.isObject)(l.securityConfig.gcsConfig)){var v=s.definitions.GCSConfig.properties.securityConfig.definitions.GCSValues.properties;return d(l.securityConfig.gcsConfig,v)}return E=s.definitions.GCSConfig.properties.securityConfig.definitions.GCSCredentialsPath,d(l,E)}if(Object.keys(t[i]).includes("oneOf")){if((null===(r=l.securityConfig)||void 0===r?void 0:r.awsAccessKeyId)||(null===(o=l.securityConfig)||void 0===o?void 0:o.awsSecretAccessKey)){E=s.definitions.S3Config.properties.securityConfig.properties;return d(l.securityConfig,E)}}else if(Object.keys(t[i]).includes("$ref")){var w=t[i].$ref.split("/").splice(2);E=s.definitions[w];return d(l,E)}}}))};return(0,f.useEffect)((function(){switch(n.slice(0,-1)){case de.py.DATABASE_SERVICE:o((0,fe.c)(i).schema);break;case de.py.DASHBOARD_SERVICE:o((0,me.n)(i).schema);break;case de.py.MESSAGING_SERVICE:o((0,pe.m)(i).schema);break;case de.py.PIPELINE_SERVICE:o((0,ve.o)(i).schema);break;case de.py.MLMODEL_SERVICE:o((0,Ee.$)(i).schema);break;case de.py.METADATA_SERVICE:o((0,ge.J)(i).schema)}}),[n,i]),(0,f.useEffect)((function(){(0,m.isEmpty)(s)||u(d(t,s.properties))}),[s]),f.createElement("div",{className:"tw-bg-white"},f.createElement("div",{className:"tw-w-full tw-p-5 tw-flex tw-flex-wrap tw-border tw-rounded-lg tw-border-gray-300","data-testid":"service-connection-details"},c))},he=n(57269),be=n(96162),ye=n(22653),Se=n(89204),Ce=n(55546),Ze=n(2798),Ie=n(6929),Re=n(39570),Ae=n(35892),ke=n(19790),Ne=function(){var e,t,n,_,M,z,L,H,G=(0,g.UO)(),B=G.serviceFQN,J=G.serviceType,U=G.serviceCategory,Q=G.tab,W=(0,se.BL)().getEntityPermissionByFqn,$=(0,g.k6)(),ee=(0,a.CR)((0,f.useState)(U||(0,Ae.oQ)(J)),2),te=ee[0],ne=ee[1],ie=(0,a.CR)((0,f.useState)([]),2),re=ie[0],oe=ie[1],le=(0,a.CR)((0,f.useState)(!1),2),de=le[0],me=le[1],fe=(0,a.CR)((0,f.useState)(""),2),pe=fe[0],ge=fe[1],Ee=(0,a.CR)((0,f.useState)(),2),ve=Ee[0],Ne=Ee[1],Pe=(0,a.CR)((0,f.useState)([]),2),Ve=Pe[0],xe=Pe[1],De=(0,a.CR)((0,f.useState)(!0),2),Te=De[0],Oe=De[1],_e=(0,a.CR)((0,f.useState)(j.OQ),2),Me=_e[0],ze=_e[1],Le=(0,a.CR)((0,f.useState)(0),2),He=Le[0],Ge=Le[1],Be=(0,a.CR)((0,f.useState)((0,Ae.c)(Q,te)),2),Je=Be[0],je=Be[1],Fe=(0,a.CR)((0,f.useState)(!1),2),Ue=Fe[0],Qe=Fe[1],We=(0,a.CR)((0,f.useState)([]),2),qe=We[0],Ke=We[1],$e=(0,a.CR)((0,f.useState)([]),1)[0],Xe=(0,a.CR)((0,f.useState)({}),2),Ye=Xe[0],et=Xe[1],tt=(0,a.CR)((0,f.useState)(1),2),nt=tt[0],at=tt[1],it=(0,a.CR)((0,f.useState)(1),2),rt=it[0],st=it[1],ot=(0,a.CR)((0,f.useState)(),2),lt=ot[0],ct=ot[1],ut=(0,a.CR)((0,f.useState)(!1),2),dt=ut[0],mt=ut[1],ft=(0,a.CR)((0,f.useState)(),2),pt=ft[0],gt=ft[1],Et=(0,a.CR)((0,f.useState)(0),2),vt=Et[0],wt=Et[1],ht=(0,a.CR)((0,f.useState)(0),2),bt=ht[0],yt=ht[1],St=(0,a.CR)((0,f.useState)(!1),2),Ct=St[0],Zt=St[1],It=(0,a.CR)((0,f.useState)(Re.Bd),2),Rt=It[0],At=It[1],kt=(0,a.CR)((0,f.useState)(!1),2),Nt=kt[0],Pt=kt[1],Vt=(0,f.useMemo)((function(){return(0,Ae.jz)(J)}),[J]),xt=(0,f.useMemo)((function(){return(0,Ae.sz)(te,He,qe,Rt)}),[te,He,qe,Rt]),Dt=[{key:"Owner",value:"team"===(null===(e=null==ve?void 0:ve.owner)||void 0===e?void 0:e.type)?(0,j.bV)((null===(t=null==ve?void 0:ve.owner)||void 0===t?void 0:t.name)||""):(null===(n=null==ve?void 0:ve.owner)||void 0===n?void 0:n.name)||"",placeholderText:(null===(_=null==ve?void 0:ve.owner)||void 0===_?void 0:_.displayName)||(null===(M=null==ve?void 0:ve.owner)||void 0===M?void 0:M.name)||"",isLink:"team"===(null===(z=null==ve?void 0:ve.owner)||void 0===z?void 0:z.type),openInNewTab:!1,profileName:(null===(L=null==ve?void 0:ve.owner)||void 0===L?void 0:L.type)===Ce.jc.USER?null===(H=null==ve?void 0:ve.owner)||void 0===H?void 0:H.name:void 0}],Tt=function(e){je(e);var t=e-1;(0,Ae.ip)((0,Ae.Vc)(te))[t].path!==Q&&(je((0,Ae.c)((0,Ae.ip)((0,Ae.Vc)(te))[t].path,te)),$.push({pathname:(0,j.LE)(B,U,(0,Ae.ip)((0,Ae.Vc)(te))[t].path)}))},Ot=function(e){Oe(!0),(0,w.Pj)(["owner","pipelineStatuses"],B,e).then((function(e){e.data?(Ke(e.data),et(e.paging)):(et({}),(0,Y.Eo)(Ie.Z["api-error-messages"]["fetch-ingestion-error"]))})).catch((function(e){(0,Y.Eo)(e,Ie.Z["api-error-messages"]["fetch-ingestion-error"])})).finally((function(){Oe(!1),lt||(0,h.oQ)().then((function(e){if(!e.apiEndpoint)throw ct(""),Ie.Z["api-error-messages"]["unexpected-server-response"];ct(e.apiEndpoint)})).catch((function(e){(0,Y.Eo)(e,Ie.Z["api-error-messages"]["fetch-airflow-config-error"])}))}))},_t=function(e){switch(te){case Se.u.DATABASE_SERVICES:!function(e){Oe(!0),(0,v.Cp)(B,["owner","usageSummary"],e).then((function(e){e?(xe(e.data),(0,Ae.nO)(e.data,wt),(0,Ae.$4)(e.data,yt),ze(e.paging),Ge(e.paging.total),Oe(!1)):(xe([]),ze(j.OQ),Oe(!1))})).catch((function(){Oe(!1)}))}(e);break;case Se.u.MESSAGING_SERVICES:!function(e){Oe(!0),(0,C.BB)(B,["owner","tags"],e).then((function(e){e.data?(xe(e.data),ze(e.paging),Ge(e.paging.total),Oe(!1)):(xe([]),ze(j.OQ),Oe(!1))})).catch((function(){Oe(!1)}))}(e);break;case Se.u.DASHBOARD_SERVICES:!function(e){Oe(!0),(0,E.YK)(B,["owner","usageSummary","tags"],e).then((function(e){e.data?(xe(e.data),ze(e.paging),Ge(e.paging.total),Oe(!1)):(xe([]),ze(j.OQ),Oe(!1))})).catch((function(){Oe(!1)}))}(e);break;case Se.u.PIPELINE_SERVICES:!function(e){Oe(!0),(0,y.qk)(B,["owner","tags"],e).then((function(e){e.data?(xe(e.data),ze(e.paging),Ge(e.paging.total),Oe(!1)):(xe([]),ze(j.OQ),Oe(!1))})).catch((function(){Oe(!1)}))}(e);break;case Se.u.ML_MODEL_SERVICES:!function(e){void 0===e&&(e=""),Oe(!0),(0,b.pB)(B,e,["owner","tags"]).then((function(e){e.data?(xe(e.data),ze(e.paging),Ge(e.paging.total),Oe(!1)):(xe([]),ze(j.OQ),Oe(!1))})).catch((function(){Oe(!1)}))}(e)}},Mt=function(e){switch(te){case Se.u.MESSAGING_SERVICES:return(0,ke.Ch)(ye.W.TOPIC,e);case Se.u.DASHBOARD_SERVICES:return(0,ke.Ch)(ye.W.DASHBOARD,e);case Se.u.PIPELINE_SERVICES:return(0,ke.Ch)(ye.W.PIPELINE,e);case Se.u.ML_MODEL_SERVICES:return(0,ke.Ch)(ye.W.MLMODEL,e);case Se.u.DATABASE_SERVICES:default:return"/database/"+e}};(0,f.useEffect)((function(){ne(U||(0,Ae.oQ)(J))}),[U,J]),(0,f.useEffect)((function(){(Rt.ViewAll||Rt.ViewBasic)&&(Oe(!0),(0,S.dO)(te,B,"owner").then((function(e){var t;if(e){var n=e.description,a=e.serviceType;Ne(e),gt(null===(t=e.connection)||void 0===t?void 0:t.config),ge(null!=n?n:""),oe([{name:(0,m.startCase)(te||""),url:(0,K.si)(be.CZ.SERVICES,(0,Ae.tJ)(te))},{name:(0,q.C_)(e),url:"",imgSrc:a?(0,Ae.zF)(a):void 0,activeTitle:!0}]),_t()}else(0,Y.Eo)(Ie.Z["api-error-messages"]["fetch-service-error"])})).catch((function(e){var t;404===(null===(t=e.response)||void 0===t?void 0:t.status)?Qe(!0):(0,Y.Eo)(e,Ie.Z["api-error-messages"]["fetch-service-error"])})).finally((function(){return Oe(!1)})))}),[B,te,Rt,J]),(0,f.useEffect)((function(){var e;if(Rt.ViewAll||Rt.ViewBasic){var t=(0,Ae.c)(Q,te);(null===(e=xt[t-1])||void 0===e?void 0:e.isProtected)&&Tt(1),new Promise((function(e,t){(0,w.x1)().then((function(n){200===n.status?e():t()})).catch((function(){return t()}))})).then((function(){mt(!0),Ot()})).catch((function(){mt(!1)}))}}),[Rt]);var zt=function(e){var t={connection:null==ve?void 0:ve.connection,name:null==ve?void 0:ve.name,serviceType:null==ve?void 0:ve.serviceType,owner:e,description:null==ve?void 0:ve.description};return new Promise((function(e,n){var a;(0,S.Pg)(te,null!==(a=null==ve?void 0:ve.id)&&void 0!==a?a:"",t).then((function(t){return t?(Ne(t),e()):((0,Y.Eo)(Ie.Z["api-error-messages"]["update-owner-error"]),n())})).catch((function(e){return(0,Y.Eo)(e,Ie.Z["api-error-messages"]["update-owner-error"]),n()}))}))},Lt=function(){var e=(0,a.pi)((0,a.pi)({},ve),{owner:void 0});return new Promise((function(t,n){var a;(0,S.Pg)(te,null!==(a=null==ve?void 0:ve.id)&&void 0!==a?a:"",e).then((function(e){e?(Ne(e),t()):(0,Y.Eo)(Ie.Z["api-error-messages"]["update-owner-error"]),n()})).catch((function(e){(0,Y.Eo)(e,Ie.Z["api-error-messages"]["update-owner-error"]),n()}))}))};(0,f.useEffect)((function(){(0,Ae.ip)((0,Ae.Vc)(te))[Je-1].path!==Q&&je((0,Ae.c)(Q,te))}),[Q]),(0,f.useEffect)((function(){(0,a.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:Oe(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,W((0,Ae.rq)(U),B)];case 2:return e=n.sent(),At(e),[3,5];case 3:return t=n.sent(),(0,Y.Eo)(t),[3,5];case 4:return Oe(!1),[7];case 5:return[2]}}))}))}),[B,U]);var Ht=(0,f.useMemo)((function(){var e=(0,a.CR)(function(e){switch(e){case Se.u.DATABASE_SERVICES:return[(0,d.t)("label.database-name"),(0,d.t)("label.usage")];case Se.u.MESSAGING_SERVICES:return[(0,d.t)("label.topic-name"),(0,d.t)("label.tag-plural")];case Se.u.DASHBOARD_SERVICES:return[(0,d.t)("label.dashboard-name"),(0,d.t)("label.tag-plural")];case Se.u.PIPELINE_SERVICES:return[(0,d.t)("label.pipeline-name"),(0,d.t)("label.tag-plural")];case Se.u.ML_MODEL_SERVICES:return[(0,d.t)("label.model-name"),(0,d.t)("label.tag-plural")];default:return[]}}(te),2),t=e[0],n=e[1];return[{title:t,dataIndex:"displayName",key:"displayName",render:function(e,t){return f.createElement(p.Link,{to:Mt(t.fullyQualifiedName||"")},(0,m.isUndefined)(e)?(0,q.C_)(t):e)}},{title:(0,d.t)("label.description"),dataIndex:"description",key:"description",render:function(e){return!(0,m.isUndefined)(e)&&e.trim()?f.createElement(x.Z,{markdown:e}):f.createElement("span",{className:"tw-no-description"},(0,d.t)("label.no-description"))}},{title:(0,d.t)("label.owner"),dataIndex:"owner",key:"owner",render:function(e){var t;return(0,m.isUndefined)(e)?f.createElement(r.Z.Text,{"data-testid":"no-owner-text"},"--"):f.createElement(i.Z,{"data-testid":"owner-data"},f.createElement(V.Z,{id:"",name:null!==(t=e.name)&&void 0!==t?t:"",type:"circle",width:"24"}),f.createElement(r.Z.Text,{"data-testid":e.name+"-owner-name"},(0,q.C_)(e)))}},{title:n,dataIndex:(0,m.toLower)(n),key:(0,m.toLower)(n),render:function(e,t){return f.createElement("div",{"data-testid":"record-tags"},function(e){var t,n,a,i,r,s;switch(te){case Se.u.DATABASE_SERVICES:var o=e;return f.createElement("p",null,(0,ke.Vm)((null===(n=null===(t=null==o?void 0:o.usageSummary)||void 0===t?void 0:t.weeklyStats)||void 0===n?void 0:n.percentileRank)||0));case Se.u.MESSAGING_SERVICES:var l=e;return l.tags&&(null===(a=l.tags)||void 0===a?void 0:a.length)>0?f.createElement(he.Z,{showStartWith:!1,sizeCap:-1,tags:l.tags,type:"border"}):"--";case Se.u.DASHBOARD_SERVICES:var c=e;return c.tags&&(null===(i=c.tags)||void 0===i?void 0:i.length)>0?f.createElement(he.Z,{showStartWith:!1,sizeCap:-1,tags:c.tags,type:"border"}):"--";case Se.u.PIPELINE_SERVICES:var u=e;return u.tags&&(null===(r=u.tags)||void 0===r?void 0:r.length)>0?f.createElement(he.Z,{showStartWith:!1,sizeCap:-1,tags:u.tags,type:"border"}):"--";case Se.u.ML_MODEL_SERVICES:var d=e;return d.tags&&(null===(s=d.tags)||void 0===s?void 0:s.length)>0?f.createElement(he.Z,{showStartWith:!1,sizeCap:-1,tags:d.tags,type:"border"}):"--";default:return f.createElement(f.Fragment,null)}}(t))}}]}),[]);return f.createElement(O.Z,null,Te?f.createElement(ae.Z,null):Ue?f.createElement(k.Z,null,(0,q.mW)(te,B)):f.createElement(f.Fragment,null,Rt.ViewAll||Rt.ViewBasic?f.createElement(s.Z,{className:"p-x-md p-t-lg","data-testid":"service-page",gutter:[0,12]},f.createElement(o.Z,{span:24},f.createElement(i.Z,{align:"center",className:"justify-between w-full"},f.createElement(T.Z,{titleLinks:re}),(null==ve?void 0:ve.serviceType)!==Ze.G5.OpenMetadata&&f.createElement(l.Z,{title:Rt.Delete?(0,d.t)("label.delete"):(0,d.t)("message.no-permission-for-action")},f.createElement(Z.z,{"data-testid":"service-delete",disabled:!Rt.Delete,size:"small",theme:"primary",variant:"outlined",onClick:function(){Zt(!0)}},f.createElement(X.Is,{className:"tw-mr-1.5",height:14,viewBox:"0 0 24 24",width:14}),(0,d.t)("label.delete"))),f.createElement(I.Z,{isRecursiveDelete:!0,afterDeleteAction:function(){return $.push((0,K.si)(be.CZ.SERVICES,ue.cP[U]))},allowSoftDelete:!1,deleteMessage:(0,Ae.gr)(te||"",He,vt,bt),entityId:null==ve?void 0:ve.id,entityName:(null==ve?void 0:ve.name)||"",entityType:null==te?void 0:te.slice(0,-1),visible:Ct,onCancel:function(){return Zt(!1)}}))),f.createElement(o.Z,{span:24},f.createElement(i.Z,null,Dt.map((function(e,t){return f.createElement(i.Z,{key:t},f.createElement(A.Z,{currentOwner:null==ve?void 0:ve.owner,data:e,removeOwner:Rt.EditAll||Rt.EditOwner?Lt:void 0,updateOwner:Rt.EditAll||Rt.EditOwner?zt:void 0}))})))),f.createElement(o.Z,{"data-testid":"description-container",span:24},f.createElement(R.Z,{description:pe||"",entityFqn:B,entityName:B,entityType:U.slice(0,-1),hasEditAccess:Rt.EditAll||Rt.EditDescription,isEdit:de,onCancel:function(){me(!1)},onDescriptionEdit:function(){me(!0)},onDescriptionUpdate:function(e){return(0,a.mG)(void 0,void 0,void 0,(function(){var t,n,i,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if(pe===e||(0,m.isUndefined)(ve))return[3,6];t=ve.id,n={connection:null==ve?void 0:ve.connection,name:ve.name,serviceType:ve.serviceType,description:e,owner:ve.owner},a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,(0,S.Pg)(te,t,n)];case 2:return i=a.sent(),ge(e),Ne(i),[3,5];case 3:return r=a.sent(),(0,Y.Eo)(r),[3,5];case 4:return me(!1),[7];case 5:return[3,7];case 6:me(!1),a.label=7;case 7:return[2]}}))}))}})),f.createElement(o.Z,{span:24},f.createElement(D.Z,{activeTab:Je,className:"tw-flex-initial",setActiveTab:Tt,tabs:xt}),f.createElement(o.Z,{span:24},1===Je&&((0,m.isEmpty)(Ve)?f.createElement(k.Z,{doc:F.lS,heading:ue.N9[te]}):f.createElement("div",{"data-testid":"table-container"},f.createElement(u.Z,{bordered:!0,className:"mt-4 table-shadow",columns:Ht,components:{body:{row:function(e){var t=e.children;return f.createElement("tr",{"data-testid":"row"},t)}}},"data-testid":"service-children-table",dataSource:Ve,pagination:!1,rowKey:"id",size:"small"}),Boolean(!(0,m.isNil)(Me.after)||!(0,m.isNil)(Me.before))&&f.createElement(P.Z,{currentPage:nt,pageSize:j.IV,paging:Me,pagingHandler:function(e,t){var n="&"+e+"="+Me[e];_t(n),at(null!=t?t:1)},totalCount:Me.total}))),2===Je&&(dt?(0,m.isUndefined)(lt)?f.createElement(ae.Z,null):f.createElement("div",{"data-testid":"ingestion-container"},f.createElement(ce,{isRequiredDetailsAvailable:!0,airflowEndpoint:lt,currrentPage:rt,deleteIngestion:function(e,t){return new Promise((function(n,a){(0,w.cB)(e).then((function(){n(),Ot()})).catch((function(e){(0,Y.Eo)(e,Ie.Z["api-error-messages"]["delete-ingestion-error"]+" "+t),a()}))})).finally((function(){return Oe(!1)}))},deployIngestion:function(e){return new Promise((function(t,n){return(0,w.aw)(e).then((function(e){if(!e.data)throw Ie.Z["api-error-messages"]["update-ingestion-error"];t(),setTimeout((function(){Ot(),Oe(!1)}),500)})).catch((function(e){(0,Y.Eo)(e,Ie.Z["api-error-messages"]["update-ingestion-error"]),n()}))}))},handleEnableDisableIngestion:function(e){(0,w.g6)(e).then((function(e){if(!e.data)throw Ie.Z["api-error-messages"]["unexpected-server-response"];Ot()})).catch((function(e){(0,Y.Eo)(e,Ie.Z["api-error-messages"]["unexpected-server-response"])}))},ingestionList:qe,paging:Ye,pagingHandler:function(e,t){var n="&"+e+"="+Ye[e];Ot(n),st(null!=t?t:1)},permissions:Rt,serviceCategory:te,serviceDetails:ve,serviceList:$e,serviceName:B,triggerIngestion:function(e,t){return new Promise((function(n,a){(0,w.FD)(e).then((function(e){e.data?(n(),Ot()):(a(),(0,Y.Eo)(Ie.Z["api-error-messages"]["triggering-ingestion-error"]+" "+t))})).catch((function(e){(0,Y.Eo)(e,Ie.Z["api-error-messages"]["triggering-ingestion-error"]+" "+t),a()})).finally((function(){return Oe(!1)}))}))},onIngestionWorkflowsUpdate:Ot})):f.createElement(N.Z,null)),3===Je&&f.createElement(f.Fragment,null,f.createElement(i.Z,{className:"w-full my-4 justify-end"},f.createElement(l.Z,{title:Rt.EditAll?(0,d.t)("label.edit-entity",{entity:(0,d.t)("label.connection")}):(0,d.t)("message.no-permission-for-action")},f.createElement(c.Z,{ghost:!0,"data-testid":"edit-connection-button",disabled:!Rt.EditAll,type:"primary",onClick:function(){$.push((0,K.Pj)(te||"",B||""))}},(0,d.t)("label.edit-entity",{entity:(0,d.t)("label.connection")}))),Vt&&dt&&f.createElement(l.Z,{title:Rt.EditAll?(0,d.t)("label.test-connection"):(0,d.t)("message.no-permission-for-action")},f.createElement(c.Z,{"data-testid":"test-connection-button",disabled:!Rt.EditAll||Nt||U===Se.u.METADATA_SERVICES&&B===ue.sl,loading:Nt,type:"primary",onClick:function(){return(0,a.mG)(void 0,void 0,void 0,(function(){var e;return(0,a.Jh)(this,(function(t){switch(t.label){case 0:if(!pt)return[3,5];Pt(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,(0,S.mX)(pt,(0,Ae.Qw)(U))];case 2:if(200!==t.sent().status)throw Ie.Z["api-error-messages"]["unexpected-server-response"];return(0,Y.XA)(Ie.Z["api-success-messages"]["test-connection-success"]),[3,5];case 3:return e=t.sent(),(0,Y.Eo)(e,Ie.Z["api-error-messages"]["test-connection-error"]),[3,5];case 4:return Pt(!1),[7];case 5:return[2]}}))}))}},(0,d.t)("label.test-connection")))),f.createElement(we,{connectionDetails:pt||{},serviceCategory:U,serviceFQN:(null==ve?void 0:ve.serviceType)||""}))))):f.createElement(k.Z,null,(0,d.t)("message.no-permission-to-view"))))}}}]);