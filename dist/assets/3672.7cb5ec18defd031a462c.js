"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[3672],{83672:function(e,t,n){n.r(t);var a=n(70655),r=n(71230),i=n(15746),u=n(91894),s=n(56256),l=n(9242),c=n(19650),o=n(71577),m=n(60236),f=n(96486),d=n(67294),p=n(59293),E=n(63153),h=n(84419),b=n(53867),v=n(96162),w=n(85303),Z=n(48132),y=n(96840),C=n(50168),k=n(87684),g=(0,y.DW)(v.lx.POLICIES),N={name:"",description:"",resources:[],operations:[],condition:"",effect:w.Q.Allow};t.default=function(){var e=(0,p.k6)(),t=(0,p.UO)(),n=t.fqn,v=t.ruleName,w=(0,a.CR)((0,d.useState)(!1),2),S=w[0],R=w[1],_=(0,a.CR)((0,d.useState)({}),2),D=_[0],P=_[1],j=(0,a.CR)((0,d.useState)(N),2),q=j[0],x=j[1],G=(0,d.useMemo)((function(){return[{name:"Settings",url:(0,y.si)()},{name:"Policies",url:g},{name:(0,Z.C_)(D),url:(0,y.Hr)(n)},{name:v,url:""}]}),[n,D,v]),H=function(){e.push((0,y.Hr)(n))};return(0,d.useEffect)((function(){(0,a.mG)(void 0,void 0,void 0,(function(){var e,t,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:R(!0),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,(0,E.u7)(n,"owner,location,teams,roles")];case 2:return(e=a.sent())?(P(e),t=e.rules.find((function(e){return e.name===v})),x(null!=t?t:N)):P({}),[3,5];case 3:return r=a.sent(),(0,C.Eo)(r),[3,5];case 4:return R(!1),[7];case 5:return[2]}}))}))}),[n]),S?d.createElement(b.Z,null):d.createElement(r.Z,{className:"tw-bg-body-main tw-h-auto p-y-lg",gutter:[16,16]},d.createElement(i.Z,{offset:5,span:14},d.createElement(h.Z,{className:"m-b-md",titleLinks:G}),d.createElement(u.Z,null,d.createElement(s.Z.Paragraph,{className:"tw-text-base","data-testid":"edit-rule-title"},"Edit Rule ",'"'+v+'"'),d.createElement(l.Z,{"data-testid":"rule-form",id:"rule-form",initialValues:{ruleEffect:q.effect,ruleName:q.name,resources:q.resources,operations:q.operations,condition:q.condition},layout:"vertical",onFinish:function(){return(0,a.mG)(void 0,void 0,void 0,(function(){var e,t,n,r;return(0,a.Jh)(this,(function(i){switch(i.label){case 0:e=D.rules,t=e.map((function(e){if(e.name===v){var t=(0,a.pi)((0,a.pi)({},q),{name:(0,f.trim)(q.name)}),n=t.condition,r=(0,a._T)(t,["condition"]);return n?(0,a.pi)((0,a.pi)({},r),{condition:n}):r}return e})),n=(0,m.qu)(D,(0,a.pi)((0,a.pi)({},D),{rules:t})),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(0,E.$j)(n,D.id)];case 2:return i.sent()&&H(),[3,4];case 3:return r=i.sent(),(0,C.Eo)(r),[3,4];case 4:return[2]}}))}))}},d.createElement(k.Z,{ruleData:q,setRuleData:x}),d.createElement(c.Z,{align:"center",className:"tw-w-full tw-justify-end"},d.createElement(o.Z,{"data-testid":"cancel-btn",type:"link",onClick:H},"Cancel"),d.createElement(o.Z,{"data-testid":"submit-btn",form:"rule-form",htmlType:"submit",type:"primary"},"Submit"))))))}}}]);