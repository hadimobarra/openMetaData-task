"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[4826],{179:function(e,t,n){n.d(t,{Z:function(){return A}});var a=n(70655),r=n(96486),i=n(67294),c=n(32822),l=n(22503),s=n(89204),o=n(6929),u=n(65131),m=n(31487),d=n(98736),p=n(41642),w=n(11384),f=n(81706),v=n(79469),h=n(35892),E=n(50168),g=n(67814),C=n(8056),y=n(94184),S=n.n(y),b=n(38464),N=n(10584),x=function(e){return i.createElement(i.Fragment,null,i.createElement("div",{className:"tw-flex tw-justify-between tw-items-center"},i.createElement("div",null,i.createElement("label",{className:"control-label"},e.title),i.createElement("p",{className:"field-description"},e.schema.description)),e.canAdd&&i.createElement(N.z,{className:"tw-h-7 tw-w-7 tw-px-2","data-testid":"add-item-"+e.title,size:"small",theme:"primary",variant:"contained",onClick:e.onAddClick},i.createElement(g.G,{icon:"plus"}))),e.items.map((function(e,t){return i.createElement("div",{className:S()("tw-flex tw-items-center tw-w-full",{"tw-mt-2":t>0}),key:e.key+"-"+t},i.createElement("div",{className:"tw-flex-1 array-fields"},e.children),e.hasRemove&&i.createElement("button",{className:"focus:tw-outline-none tw-w-7 tw-ml-3",type:"button",onClick:function(t){e.onDropIndexClick(e.index)(t)}},i.createElement(b.ZP,{alt:"delete",icon:b.PJ.DELETE,title:"Delete",width:"16px"})))})))},k=function(e){return i.createElement(i.Fragment,null,i.createElement("div",{className:"tw-flex tw-justify-between tw-items-center"},i.createElement("div",null,i.createElement("label",{className:"control-label",id:e.idSchema.$id+"__title"},e.title),i.createElement("p",{className:"field-description",id:e.idSchema.$id+"__description"},e.description)),e.schema.additionalProperties&&i.createElement(N.z,{className:"tw-h-7 tw-w-7 tw-px-2","data-testid":"add-item-"+e.title,id:e.idSchema.$id+"__add",size:"small",theme:"primary",variant:"contained",onClick:function(){e.onAddClick(e.schema)()}},i.createElement(g.G,{icon:"plus"}))),e.properties.map((function(t,n){return i.createElement("div",{className:S()("property-wrapper",{"additional-fields":e.schema.additionalProperties}),key:t.content.key+"-"+n},t.content)})))},R=n(53867),T=function(e){var t=e.formData,n=e.schema,l=e.okText,s=e.cancelText,o=e.showFormHeader,u=void 0!==o&&o,m=e.status,p=void 0===m?"initial":m,w=e.onCancel,f=e.onSubmit,v=e.onTestConnection,h=e.uiSchema,E=e.isAirflowAvailable,y=e.disableTestConnection,T=(0,a._T)(e,["formData","schema","okText","cancelText","showFormHeader","status","onCancel","onSubmit","onTestConnection","uiSchema","isAirflowAvailable","disableTestConnection"]),A=(0,i.useRef)(),D=(0,a.CR)((0,i.useState)((0,d.jv)(t)),2),I=D[0],P=D[1],z=(0,a.CR)((0,i.useState)(!1),2),Z=z[0],L=z[1],V=(0,a.CR)((0,i.useState)("initial"),2),_=V[0],B=V[1],F=(0,a.CR)((0,i.useState)("[fetching]"),2),j=F[0],M=F[1];return(0,i.useEffect)((function(){E&&(0,a.mG)(void 0,void 0,void 0,(function(){var e;return(0,a.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,c.ut)()];case 1:return e=t.sent(),M((null==e?void 0:e.ip)||"[unknown]"),[3,3];case 2:return t.sent(),M("[error - unknown]"),[3,3];case 3:return[2]}}))}))}),[E]),i.createElement(C.ZP,(0,a.pi)({ArrayFieldTemplate:x,ObjectFieldTemplate:k,className:S()("rjsf",T.className,{"no-header":!u}),formData:I,ref:A,schema:n,showErrorList:!1,transformErrors:function(e){return e.map((function(e){var t=e.params.missingProperty,n=(0,r.startCase)(t)+" is required";return e.message=n,e}))},uiSchema:h,onChange:function(e){var t;t=e.formData,P(t),T.onChange&&T.onChange(e)},onSubmit:f},T),(0,r.isEmpty)(n)&&i.createElement("div",{className:"tw-text-grey-muted tw-text-center"},"No Connection Configs available."),!(0,r.isEmpty)(n)&&E&&i.createElement("div",{className:"tw-flex tw-justify-between tw-bg-white tw-border tw-border-main tw-shadow tw-rounded tw-p-3 tw-mt-4","data-testid":"ip-address"},i.createElement("div",{className:"tw-self-center"},"MCI-DGP will connect to your resource from the IP ",j,". Make sure to allow inbound traffic in your network security settings.")),!(0,r.isEmpty)(n)&&v&&i.createElement("div",{className:"tw-flex tw-justify-between tw-bg-white tw-border tw-border-main tw-shadow tw-rounded tw-p-3 tw-mt-4"},i.createElement("div",{className:"tw-self-center"},function(){switch(_){case"waiting":return i.createElement("div",{className:"tw-flex"},i.createElement(R.Z,{size:"small",type:"default"})," ",i.createElement("span",{className:"tw-ml-2"},"Testing Connection"));case"success":return i.createElement("div",{className:"tw-flex"},i.createElement(b.ZP,{alt:"success-badge",icon:b.PJ.SUCCESS_BADGE}),i.createElement("span",{className:"tw-ml-2"},"Connection test was successful"));default:return"Test your connections before creating the service"}}()),i.createElement(N.z,{className:S()("tw-self-center tw-py-1 tw-px-1.5",{"tw-opacity-40":Z}),"data-testid":"test-connection-btn",disabled:Z||y,size:"small",theme:"primary",variant:"outlined",onClick:function(){I&&v&&(L(!0),B("waiting"),v(I).then((function(){B("success")})).catch((function(){B("initial")})).finally((function(){L(!1)})))}},"Test Connection")),i.createElement("div",{className:"tw-mt-6 tw-flex tw-justify-between"},i.createElement("div",null),i.createElement("div",{className:"tw-text-right","data-testid":"buttons"},i.createElement(N.z,{size:"regular",theme:"primary",variant:"text",onClick:function(){P((0,d.jv)(t)),w&&w()}},s),"waiting"===p?i.createElement(N.z,{disabled:!0,className:"tw-w-16 tw-h-10 disabled:tw-opacity-100",size:"regular",theme:"primary",variant:"contained"},i.createElement(R.Z,{size:"small",type:"white"})):"success"===p?i.createElement(N.z,{disabled:!0,className:"tw-w-16 tw-h-10 disabled:tw-opacity-100",size:"regular",theme:"primary",variant:"contained"},i.createElement(g.G,{icon:"check"})):i.createElement(N.z,{className:"tw-w-16 tw-h-10","data-testid":"submit-btn",size:"regular",theme:"primary",variant:"contained",onClick:function(){A.current&&A.current.submit()}},l))))},A=function(e){var t,n=e.data,g=e.okText,C=void 0===g?"Save":g,y=e.cancelText,S=void 0===y?"Cancel":y,b=e.serviceType,N=e.serviceCategory,x=e.status,k=e.onCancel,R=e.onSave,A=e.disableTestConnection,D=void 0!==A&&A,I=(0,a.CR)((0,i.useState)(!1),2),P=I[0],z=I[1],Z=(0,i.useMemo)((function(){return(0,h.jz)(b)}),[b]),L=(0,r.isNil)(n)?{}:null===(t=n.connection)||void 0===t?void 0:t.config,V=function(e){var t=(0,d.Fz)(e.formData);R((0,a.pi)((0,a.pi)({},e),{formData:t}))},_=function(e){var t=(0,d.Fz)(e);return new Promise((function(e,n){(0,l.mX)(t,(0,h.Qw)(N)).then((function(t){if(200!==t.status)throw o.Z["api-error-messages"]["unexpected-server-response"];e()})).catch((function(e){(0,E.Eo)(e,o.Z["api-error-messages"]["test-connection-error"]),n(e)}))}))};return(0,i.useEffect)((function(){(0,c.x1)().then((function(e){200===e.status?z(!0):z(!1)})).catch((function(e){console.log(e)}))}),[]),i.createElement(i.Fragment,null,function(){var e,t,n={schema:{},uiSchema:{}},c=(0,r.cloneDeep)(L||{});try{for(var l=(0,a.XA)(Object.entries(c)),o=l.next();!o.done;o=l.next()){var d=(0,a.CR)(o.value,2),h=d[0],E=d[1];(0,r.isNil)(E)&&delete c[h]}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}switch(N){case s.u.DATABASE_SERVICES:n=(0,m.c)(b);break;case s.u.MESSAGING_SERVICES:n=(0,p.m)(b);break;case s.u.DASHBOARD_SERVICES:n=(0,u.n)(b);break;case s.u.PIPELINE_SERVICES:n=(0,v.o)(b);break;case s.u.ML_MODEL_SERVICES:n=(0,f.$)(b);break;case s.u.METADATA_SERVICES:n=(0,w.J)(b)}return i.createElement(T,{cancelText:S,disableTestConnection:D,formData:c,isAirflowAvailable:P,okText:C,schema:n.schema,status:x,uiSchema:n.uiSchema,onCancel:k,onSubmit:V,onTestConnection:Z&&P?_:void 0})}())}},6603:function(e,t,n){var a=n(70655),r=n(4107),i=n(94184),c=n.n(i),l=n(96486),s=n(45697),o=n.n(s),u=n(67294),m=n(38464),d=n(53867),p=function(e){var t=e.onSearch,n=e.searchValue,i=e.typingInterval,s=void 0===i?0:i,o=e.placeholder,p=e.label,w=e.removeMargin,f=void 0!==w&&w,v=e.showLoadingStatus,h=void 0!==v&&v,E=(0,a.CR)((0,u.useState)(""),2),g=E[0],C=E[1],y=(0,a.CR)((0,u.useState)(m.PJ.SEARCHV1),2),S=y[0],b=y[1],N=(0,a.CR)((0,u.useState)("initial"),2),x=N[0],k=N[1];(0,u.useEffect)((function(){C(n)}),[n]);var R=(0,u.useCallback)((function(e){k((function(e){return"waiting"===e?"success":e})),t(e)}),[t]),T=(0,u.useCallback)((0,l.debounce)(R,s),[R]);return u.createElement("div",{className:c()("tw-group page-search-bar",{"tw-mb-4":!f}),"data-testid":"search-bar-container"},""!==p&&u.createElement("label",null,p),u.createElement("div",{className:"flex relative"},u.createElement(r.Z,{"data-testid":"searchbar",placeholder:o,prefix:u.createElement(m.ZP,{alt:"icon-search",className:"tw-w-4 tw-h-4 tw-mr-0.5",icon:S}),type:"text",value:g,onBlur:function(){return b(m.PJ.SEARCHV1)},onChange:function(e){var t=e.target.value;C(t),k((function(e){return"waiting"!==e?"waiting":e})),T(t)},onFocus:function(){return b(m.PJ.SEARCHV1COLOR)}}),h&&"waiting"===x&&u.createElement("div",{className:"tw-absolute tw-block tw-z-1 tw-w-4 tw-h-4 tw-top-2 tw-right-2.5 tw-text-center tw-pointer-events-none"},u.createElement(d.Z,{size:"small",type:"default"}))))};p.defaultProps={searchValue:"",typingInterval:1e3,placeholder:"Search...",label:""},p.propTypes={onSearch:o().func.isRequired,searchValue:o().string,typingInterval:o().number,placeholder:o().string,label:o().string},t.Z=p},46892:function(e,t,n){n.d(t,{K:function(){return l}});var a=n(94184),r=n.n(a),i=n(67294),c=n(61637),l={border:"1px rgb(221, 227, 234) solid",borderRadius:"4px",boxShadow:"1px 1px 8px rgb(0 0 0 / 6%)"};t.Z=function(e){var t=e.leftPanel,n=e.header,a=e.children,l=e.rightPanel,s=e.layout,o=void 0===s?c.Q["3Col"]:s,u=e.classes,m=void 0===u?"":u,d=function(){return t&&i.createElement("div",{className:"tw-py-1",id:"left-panel"},t)},p=function(){return l&&i.createElement("div",{className:"tw-py-1",id:"right-panel"},l)};return function(e){switch(e){case c.Q["2ColLTR"]:return i.createElement(i.Fragment,null,n&&i.createElement("div",{className:"tw-px-6"},n),i.createElement("div",{className:r()("page-layout-container l2-ltr-col tw-gap-x-3 tw-px-6 centered-layout",m,t?"page-layout-container-left-center":"page-layout-container-center")},d(),i.createElement("div",{className:r()("tw-py-1",{"tw-pl-8":t}),id:"center"},a)));case c.Q["2ColRTL"]:return i.createElement(i.Fragment,null,n&&i.createElement("div",{className:"page-layout-container tw-gap-x-3 tw-px-6 centered-layout tw-max-w-full-hd tw-pt-4"},n),i.createElement("div",{className:r()("page-layout-container l2-rtl-col tw-gap-x-3 tw-px-6 centered-layout",m,l?"page-layout-container-center-right":"page-layout-container-center")},i.createElement("div",{className:r()("tw-py-1",{"tw-pr-10":l}),id:"center"},a),p()));case c.Q["3Col"]:default:return i.createElement(i.Fragment,null,n&&i.createElement("div",{className:"tw-px-6"},n),i.createElement("div",{className:r()("page-layout-container l3-col tw-gap-x-3 tw-px-6 centered-layout",m,{"page-layout-container-left-center-right":t&&a&&l},{"page-layout-container-left-center":!l},{"page-layout-container-center-right":!t},{"page-layout-container-center":!t&&!l})},d(),i.createElement("div",{className:t||l?"tw-py-1":"",id:"center"},a),p()))}}(o)}},61637:function(e,t,n){var a;n.d(t,{Q:function(){return a}}),function(e){e["3Col"]="3-Column",e["2ColLTR"]="2-Column-ltr",e["2ColRTL"]="2-Column-rtl"}(a||(a={}))},4826:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}});var a=n(70655),r=n(96486),i=n(67294),c=n(59293),l=n(32822),s=n(22503),o=n(62761),u=n(96162),m=n(78666),d=n(16139),p=n(31968),w=n(61637),f=n(5302),v=n(48132),h=n(96840),E=n(35892),g=n(4318),C=n(78339),y=n(84419),S=n(46892),b=n(69852),N=n(179),x=n(10584),k=n(97809),R=n(33762),T=n(66827),A=n(52046),D=function(e){var t=e.serviceName,n=e.serviceType,a=e.description,r=e.showError,c=e.handleValidation,l=e.onBack,s=e.onNext,o=(0,i.useRef)();function u(){var e;return null===(e=A.Z.getCurrentUserDetails())||void 0===e?void 0:e.name}return(0,i.useEffect)((function(){if(n===T.yr.ExcelData){var e=new Event("input",{bubbles:!0});Object.defineProperty(e,"target",{writable:!1,value:{value:u()}}),c(e)}}),[]),i.createElement("div",{"data-testid":"configure-service-container"},i.createElement(R.g,null,i.createElement("label",{className:"tw-block tw-form-label",htmlFor:"serviceName"},(0,v.lp)("Service Name:")),n===T.yr.ExcelData?i.createElement("input",{readOnly:!0,className:"tw-form-inputs tw-form-inputs-padding","data-testid":"service-name",id:"serviceName",name:"serviceName",placeholder:"service name",type:"text",value:u(),onChange:c}):i.createElement("input",{className:"tw-form-inputs tw-form-inputs-padding","data-testid":"service-name",id:"serviceName",name:"serviceName",placeholder:"service name",type:"text",value:t,onChange:c}),(0,v.Ti)(r.name?"Service name is required":r.duplicateName?"Service name already exists":r.delimit?"Service name with delimiters are not allowed":r.nameWithSpace?"Service name with spaces are not allowed":r.nameLength?"Service name length must be between 1 and 128 characters":r.specialChar?"Service name contains special characters that are not allowed":"")),i.createElement(R.g,null,i.createElement("label",{className:"tw-block tw-form-label",htmlFor:"description"},"Description:"),i.createElement(k.Z,{initialValue:a,ref:o})),i.createElement(R.g,{className:"tw-flex tw-justify-end tw-mt-10"},i.createElement(x.z,{className:"tw-mr-2","data-testid":"back-button",size:"regular",theme:"primary",variant:"text",onClick:l},i.createElement("span",null,"Back")),i.createElement(x.z,{"data-testid":"next-button",size:"regular",theme:"primary",variant:"contained",onClick:function(){var e;return s((null===(e=o.current)||void 0===e?void 0:e.getEditorContent())||"")}},i.createElement("span",null,"Next"))))},I=n(94184),P=n.n(I),z=n(22132),Z=n(89204),L=n(38464),V=n(6603),_=function(e){var t=e.serviceCategory,n=e.selectServiceType,c=e.showError,l=e.serviceCategoryHandler,s=e.handleServiceTypeClick,o=e.onCancel,u=e.onNext,m=(0,a.CR)((0,i.useState)(""),2),d=m[0],p=m[1],w=(0,a.CR)((0,i.useState)(""),2),f=w[0],h=w[1],E=(0,a.CR)((0,i.useState)([]),2),g=E[0],C=E[1];(0,i.useEffect)((function(){var e=Object.values(Z.u),n=e.includes(t)?t:e[0];p(n),C(z.V9[n].filter((function(e){return!z.hD.find((function(t){return t===e}))})))}),[t]);var y=(0,i.useMemo)((function(){return g.filter((function(e){return!z.hD.includes(e)}))}),[g]);return i.createElement("div",null,i.createElement(R.g,null,i.createElement("select",{className:"tw-form-inputs tw-form-inputs-padding","data-testid":"service-category",id:"serviceCategory",name:"serviceCategory",value:d,onChange:function(e){h(""),l(e.target.value)}},Object.values(Z.u).map((function(e,t){return i.createElement("option",{key:t,value:e},(0,r.startCase)(e))})))),i.createElement(R.g,{className:"tw-mt-7"},i.createElement(R.g,null,i.createElement(V.Z,{removeMargin:!0,placeholder:"Search for connector...",searchValue:f,typingInterval:500,onSearch:function(e){h(e),C(z.V9[t].filter((function(t){return t.toLowerCase().includes(e.toLowerCase())})))}})),i.createElement("div",{className:"tw-flex"},i.createElement("div",{className:"tw-grid tw-grid-cols-6 tw-grid-flow-row tw-gap-4 tw-mt-4","data-testid":"select-service"},y.map((function(e){return i.createElement("div",{className:P()("tw-flex tw-flex-col tw-items-center tw-relative tw-p-2 tw-w-24 tw-cursor-pointer tw-border tw-rounded-md",{"tw-border-primary":e===n}),"data-testid":e,key:e,onClick:function(){return s(e)}},i.createElement("div",{className:"tw-mb-2.5"},i.createElement("div",{"data-testid":"service-icon"},(0,v.Y9)(e||"","tw-h-9")),i.createElement("div",{className:"tw-absolute tw-top-0 tw-right-1.5"},e===n&&i.createElement(L.ZP,{alt:"checkbox",icon:L.PJ.CHECKBOX_PRIMARY}))),i.createElement("p",{className:"break-word text-center"},e.includes("Custom")?(0,r.startCase)(e):e))})))),c&&(0,v.Ti)("Service is required")),i.createElement(R.g,{className:"tw-flex tw-justify-end tw-mt-10"},i.createElement(x.z,{className:P()("tw-mr-2"),"data-testid":"previous-button",size:"regular",theme:"primary",variant:"text",onClick:o},i.createElement("span",null,"Cancel")),i.createElement(x.z,{"data-testid":"next-button",size:"regular",theme:"primary",variant:"contained",onClick:u},i.createElement("span",null,"Next"))))},B=function(e){var t,n=e.serviceCategory,l=e.onAddServiceSave,s=e.newServiceData,x=e.onAddIngestionSave,k=e.ingestionProgress,R=e.isIngestionCreated,T=e.isIngestionDeployed,A=e.ingestionAction,I=e.showDeployButton,P=e.onIngestionDeploy,z=e.slashedBreadcrumb,Z=e.addIngestion,L=e.handleAddIngestion,V=e.onAirflowStatusCheck,B=(0,c.k6)(),F=(0,a.CR)((0,i.useState)({serviceType:!1,name:!1,duplicateName:!1,nameWithSpace:!1,delimit:!1,specialChar:!1,nameLength:!1,allowChar:!1,isError:!1}),2),j=F[0],M=F[1],O=(0,a.CR)((0,i.useState)(1),2),H=O[0],G=O[1],J=(0,a.CR)((0,i.useState)(1),2),Y=J[0],Q=J[1],W=(0,a.CR)((0,i.useState)(""),2),q=W[0],$=W[1],U=(0,a.CR)((0,i.useState)(""),2),X=U[0],K=U[1],ee=(0,a.CR)((0,i.useState)(""),2),te=ee[0],ne=ee[1],ae=(0,a.CR)((0,i.useState)("initial"),2),re=ae[0],ie=ae[1],ce=(0,a.CR)((0,i.useState)(!0),2),le=ce[0],se=ce[1],oe=function(){(0,r.isUndefined)(s)||B.push((0,o.LE)(s.name,n))};return i.createElement("div",{className:"tw-self-center"}," ",i.createElement(S.Z,{classes:"tw-max-w-full-hd tw-h-full tw-pt-4",header:i.createElement(y.Z,{titleLinks:z}),layout:w.Q["2ColRTL"],rightPanel:(t=Z?Y:H,(0,E.qx)(t,Z,X+"_"+f.Hz.Metadata,X,f.Hz.Metadata,Y>=3&&!I,!1,le))},i.createElement("div",{className:"tw-form-container"},Z?i.createElement(g.Z,{isAirflowSetup:!0,activeIngestionStep:Y,handleCancelClick:function(){return L(!1)},handleViewServiceClick:oe,heading:"Add "+(0,r.capitalize)(f.Hz.Metadata)+" Ingestion",ingestionAction:A,ingestionProgress:k,isIngestionCreated:R,isIngestionDeployed:T,pipelineType:f.Hz.Metadata,serviceCategory:n,serviceData:s,setActiveIngestionStep:function(e){return Q(e)},showDeployButton:I,status:p.Y.ADD,onAddIngestionSave:x,onAirflowStatusCheck:V,onIngestionDeploy:P}):i.createElement("div",{"data-testid":"add-new-service-container"},i.createElement("h6",{className:"tw-heading tw-text-base","data-testid":"header"},"Add New Service"),i.createElement(b.Z,{activeStep:H,steps:m.IL}),i.createElement("div",{className:"tw-pt-5"},1===H&&i.createElement(_,{handleServiceTypeClick:function(e){M((0,a.pi)((0,a.pi)({},j),{serviceType:!1})),K(""),ne(""),$(e)},selectServiceType:q,serviceCategory:n,serviceCategoryHandler:function(e){M((0,a.pi)((0,a.pi)({},j),{serviceType:!1})),$(""),B.push((0,h.C1)(e))},showError:j.serviceType,onCancel:function(){B.push((0,h.si)(u.CZ.SERVICES,(0,E.tJ)(n)))},onNext:function(){q?G(2):M((0,a.pi)((0,a.pi)({},j),{serviceType:!0}))}}),2===H&&i.createElement(D,{description:te,handleValidation:function(e){var t=e.target.value;K(t),t&&M((0,a.pi)((0,a.pi)({},j),{name:!1,isError:!1,delimit:!1,specialChar:!1,nameLength:!1}))},serviceName:X,serviceType:q,showError:{name:j.name,duplicateName:j.duplicateName,nameWithSpace:j.nameWithSpace,delimit:j.delimit,specialChar:j.specialChar,nameLength:j.nameLength,allowChar:j.allowChar},onBack:function(){G(1)},onNext:function(e){ne(e),X.trim()?d.Fv.test(X)?M((0,a.pi)((0,a.pi)({},j),{nameWithSpace:!0,isError:!0})):d.BJ.test(X)?M((0,a.pi)((0,a.pi)({},j),{delimit:!0,isError:!0})):d.Fv.test(X)?M((0,a.pi)((0,a.pi)({},j),{nameWithSpace:!0,isError:!0})):(0,v.Am)(X.trim())?X.length<1||X.length>128?M((0,a.pi)((0,a.pi)({},j),{nameLength:!0,isError:!0})):j.isError||G(3):M((0,a.pi)((0,a.pi)({},j),{specialChar:!0,isError:!0})):M((0,a.pi)((0,a.pi)({},j),{name:!0,isError:!0}))}}),3===H&&i.createElement(N.Z,{cancelText:"Back",serviceCategory:n,serviceType:q,status:re,onCancel:function(){G(2)},onSave:function(e){var t,n,r;t=e.formData,n={name:X,serviceType:q,description:te,owner:{id:(0,v.rc)(),type:"user"}},r=(0,a.pi)((0,a.pi)({},n),{connection:{config:t}}),new Promise((function(e,t){ie("waiting"),l(r).then((function(){new Promise((function(e){V().then((function(){se(!0)})).catch((function(){se(!1)})).finally((function(){return e()}))})).finally((function(){G(4),e()}))})).catch((function(e){t(e)})).finally((function(){return ie("initial")}))}))}}),H>3&&i.createElement(C.Z,{showIngestionButton:!0,handleIngestionClick:function(){return L(!0)},handleViewServiceClick:oe,isAirflowSetup:le,name:X,state:p.Y.ADD,suffix:(0,E.Yn)(n),onCheckAirflowStatus:V}))))))},F=n(74380),j=n(28517),M=n(6929),O=n(50168),H=function(){var e=(0,c.UO)().serviceCategory,t=(0,a.CR)((0,i.useState)(),2),n=t[0],m=t[1],d=(0,a.CR)((0,i.useState)(0),2),p=d[0],w=d[1],f=(0,a.CR)((0,i.useState)(!1),2),v=f[0],g=f[1],C=(0,a.CR)((0,i.useState)(!1),2),y=C[0],S=C[1],b=(0,a.CR)((0,i.useState)(j.g.CREATING),2),N=b[0],x=b[1],k=(0,a.CR)((0,i.useState)(""),2),R=k[0],T=k[1],A=(0,a.CR)((0,i.useState)(!1),2),D=A[0],I=A[1],P=(0,a.CR)((0,i.useState)([]),2),z=P[0],Z=P[1],L=(0,a.CR)((0,i.useState)(!1),2),V=L[0],_=L[1],H=function(e){return new Promise((function(t){g(!0),w(o.lB),x(j.g.DEPLOYING),(0,l.aw)(null!=e?e:R).then((function(){S(!0),I(!1),w(o.$M),x(j.g.DEPLOYED)})).catch((function(e){I(!0),x(j.g.DEPLOYING_ERROR),(0,O.Eo)(e||M.Z["api-error-messages"]["deploy-ingestion-error"])})).finally((function(){return t()}))}))};return(0,i.useEffect)((function(){Z([{name:(0,r.startCase)(e),url:(0,h.si)(u.CZ.SERVICES,(0,E.tJ)(e))},{name:V?"Add New Ingestion":"Add New Service",url:"",activeTitle:!0}])}),[e,V]),i.createElement(F.Z,null,i.createElement("div",{className:"tw-self-center"},i.createElement(B,{addIngestion:V,handleAddIngestion:function(e){_(e)},ingestionAction:N,ingestionProgress:p,isIngestionCreated:v,isIngestionDeployed:y,newServiceData:n,serviceCategory:e,showDeployButton:D,slashedBreadcrumb:z,onAddIngestionSave:function(e){return w(o.aN),new Promise((function(t,a){return(0,l.XZ)(e).then((function(e){var n;e?(T(null!==(n=e.id)&&void 0!==n?n:""),H(e.id).finally((function(){return t()}))):((0,O.Eo)(M.Z["api-error-messages"]["create-ingestion-error"]),a())})).catch((function(r){(0,l.ne)((null==n?void 0:n.name)+"."+e.name).then((function(e){if(!e)throw M.Z["api-error-messages"]["unexpected-server-response"];t(),(0,O.Eo)(r,M.Z["api-error-messages"]["deploy-ingestion-error"])})).catch((function(){(0,O.Eo)(r,M.Z["api-error-messages"]["create-ingestion-error"]),a()}))}))}))},onAddServiceSave:function(t){return new Promise((function(n,a){(0,s.WY)(e,t).then((function(e){e?(m(e),n()):((0,O.Eo)(M.Z["api-error-messages"]["create-service-error"]),a())})).catch((function(e){(0,O.Eo)(e,M.Z["api-error-messages"]["create-service-error"]),a()}))}))},onAirflowStatusCheck:function(){return new Promise((function(e,t){(0,l.x1)().then((function(n){200===n.status?e():t()})).catch((function(){return t()}))}))},onIngestionDeploy:H})))}}}]);