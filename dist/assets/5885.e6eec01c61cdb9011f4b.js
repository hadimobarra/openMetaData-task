"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[5885],{49857:function(e,t,n){var i=n(8081),r=n.n(i),a=n(23645),s=n.n(a)()(r());s.push([e.id,'/*\n *  Copyright 2022 Collate\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.description-markdown-editor .ant-modal-header,\n.description-markdown-editor .ant-modal-body,\n.description-markdown-editor .ant-modal-footer {\n  padding: 20px 24px;\n}\n',""]),t.Z=s},58134:function(e,t,n){var i=n(8081),r=n.n(i),a=n(23645),s=n.n(a)()(r());s.push([e.id,'/*\n *  Copyright 2022 Collate\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.roles-detail .list-table .ant-table-row .ant-table-cell:first-child,\n.roles-detail .list-table .ant-table-thead .ant-table-cell:first-child {\n  padding-left: 16px;\n}\n.roles-detail .ant-space > .ant-space-item:first-child {\n  align-self: flex-end;\n}\n',""]),t.Z=s},47368:function(e,t,n){n.d(t,{p:function(){return S}});var i=n(70655),r=n(50146),a=n(71577),s=n(56256),l=n(67294),c=n(437),o=n(50168),u=n(97809),d=n(53867),m=n(93379),p=n.n(m),f=n(7795),h=n.n(f),v=n(90569),b=n.n(v),y=n(3565),E=n.n(y),w=n(19216),C=n.n(w),Z=n(44589),g=n.n(Z),k=n(49857),A={};A.styleTagTransform=g(),A.setAttributes=E(),A.insert=b().bind(null,"head"),A.domAPI=h(),A.insertStyleElement=C(),p()(k.Z,A),k.Z&&k.Z.locals&&k.Z.locals;var S=function(e){var t=e.header,n=e.placeholder,m=e.value,p=e.onSave,f=e.onCancel,h=e.visible,v=(0,c.$)().t,b=(0,i.CR)((0,l.useState)(!1),2),y=b[0],E=b[1],w=(0,l.useRef)();return l.createElement(r.Z,{centered:!0,destroyOnClose:!0,className:"description-markdown-editor",closable:!1,"data-testid":"markdown-editor",footer:[l.createElement(a.Z,{"data-testid":"cancel",disabled:y,key:"cancelButton",type:"link",onClick:f},v("label.cancel")),l.createElement(a.Z,{"data-testid":"save",key:"saveButton",type:"primary",onClick:function(){return(0,i.mG)(void 0,void 0,void 0,(function(){var e,t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(!w.current)return[3,5];E(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,null==p?void 0:p(null!==(n=null===(t=w.current)||void 0===t?void 0:t.getEditorContent().trim())&&void 0!==n?n:"")];case 2:return i.sent(),[3,5];case 3:return e=i.sent(),(0,o.Eo)(e),[3,5];case 4:return E(!1),[7];case 5:return[2]}}))}))}},y?l.createElement(d.Z,{size:"small",type:"white"}):v("label.save"))],open:h,title:l.createElement(s.Z.Text,{"data-testid":"header"},t),width:"90%",onCancel:f},l.createElement(u.Z,{initialValue:m,placeHolder:n,ref:w}))}},67553:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});var i=n(70655),r=n(38222),a=n(71577),s=n(19650),l=n(94199),c=n(50146),o=n(56256),u=n(60236),d=n(96486),m=n(67294),p=n(437),f=n(59293),h=n(63153),v=n(66703),b=n(33891),y=n(9632),E=n(28178),w=n(84419),C=n(53867),Z=n(93389),g=n(79839),k=n(96162),A=n(64632),S=n(48132),L=n(39570),N=n(96840),I=n(50168),R=n(87119),O=n(93379),x=n.n(O),T=n(7795),D=n.n(T),_=n(90569),q=n.n(_),G=n(3565),J=n.n(G),B=n(19216),U=n.n(B),V=n(44589),P=n.n(V),K=n(58134),Q={};Q.styleTagTransform=P(),Q.setAttributes=J(),Q.insert=q().bind(null,"head"),Q.domAPI=D(),Q.insertStyleElement=U(),x()(K.Z,Q),K.Z&&K.Z.locals&&K.Z.locals;var F=n(25213),H=n(97882),Y=n(80131),M=n(62761),W=n(38464),z=function(e){var t=e.list,n=e.type,i=e.onDelete,r=e.hasAccess,s=(0,p.$)().t,c=(0,m.useMemo)((function(){return[{title:s("label.name"),dataIndex:"name",width:"200px",key:"name",render:function(e,t){var i="";switch(n){case"policy":i=(0,N.Hr)(t.fullyQualifiedName||"");break;case"team":i=(0,N.KH)(t.fullyQualifiedName||"");break;case"user":i=(0,M.ZG)(t.fullyQualifiedName||"")}return m.createElement(H.Link,{className:"hover:tw-underline tw-cursor-pointer","data-testid":"entity-name",to:i},(0,S.C_)(t))}},{title:s("label.description"),dataIndex:"description",key:"description",render:function(e,t){return m.createElement(Y.Z,{markdown:(null==t?void 0:t.description)||""})}},{title:s("label.actions"),dataIndex:"actions",width:"80px",key:"actions",render:function(e,t){return m.createElement(l.Z,{title:s(r?"label.remove":"message.no-permission-for-action")},m.createElement(a.Z,{"data-testid":"remove-action-"+(0,S.C_)(t),disabled:!r,type:"text",onClick:function(){return i(t)}},m.createElement(W.ZP,{alt:"remove",icon:W.PJ.ICON_REMOVE,title:s("label.remove")})))}}]}),[]);return m.createElement(F.Z,{bordered:!0,className:"list-table",columns:c,dataSource:t,pagination:!1,rowKey:"id",size:"small"})},$=r.Z.TabPane,X=function(){var e,t,n,O=(0,f.k6)(),x=(0,p.$)().t,T=(0,Z.BL)().getEntityPermissionByFqn,D=(0,f.UO)().fqn,_=(0,i.CR)((0,m.useState)({}),2),q=_[0],G=_[1],J=(0,i.CR)((0,m.useState)(!1),2),B=J[0],U=J[1],V=(0,i.CR)((0,m.useState)(!1),2),P=V[0],K=V[1],Q=(0,i.CR)((0,m.useState)(!1),2),F=Q[0],H=Q[1],Y=(0,i.CR)((0,m.useState)(),2),M=Y[0],W=Y[1],X=(0,i.CR)((0,m.useState)(),2),j=X[0],ee=X[1],te=(0,i.CR)((0,m.useState)(L.Bd),2),ne=te[0],ie=te[1],re=(0,N.si)(k.CZ.ACCESS,k.lx.ROLES),ae=(0,m.useMemo)((function(){return[{name:x("label.roles"),url:re},{name:D,url:""}]}),[D]);return(0,m.useEffect)((function(){(0,i.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:U(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,T(g.A.ROLE,D)];case 2:return e=n.sent(),ie(e),[3,5];case 3:return t=n.sent(),(0,I.Eo)(t),[3,5];case 4:return U(!1),[7];case 5:return[2]}}))}))}),[D]),(0,m.useEffect)((function(){(ne.ViewAll||ne.ViewBasic)&&(0,i.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:U(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,(0,h.n5)(D,"policies,teams,users")];case 2:return e=n.sent(),G(null!=e?e:{}),[3,5];case 3:return t=n.sent(),(0,I.Eo)(t),[3,5];case 4:return U(!1),[7];case 5:return[2]}}))}))}),[ne,D]),B?m.createElement(C.Z,null):m.createElement("div",{"data-testid":"role-details-container"},m.createElement(w.Z,{titleLinks:ae}),ne.ViewAll||ne.ViewBasic?m.createElement(m.Fragment,null,(0,d.isEmpty)(q)?m.createElement(E.Z,{dataTestId:"no-data"},m.createElement("div",{className:"text-center"},m.createElement("p",null,x("label.no-roles-found")," ",x("label.go-back")," ",D),m.createElement(a.Z,{className:"m-t-sm",size:"small",type:"primary",onClick:function(){return O.push(re)}},x("label.go-back")))):m.createElement("div",{className:"roles-detail","data-testid":"role-details"},m.createElement(y.Z,{description:q.description||"",entityFqn:q.fullyQualifiedName,entityName:(0,S.C_)(q),entityType:A.py.ROLE,hasEditAccess:ne.EditAll||ne.EditDescription,isEdit:F,onCancel:function(){return H(!1)},onDescriptionEdit:function(){return H(!0)},onDescriptionUpdate:function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){var t,n,r;return(0,i.Jh)(this,(function(a){switch(a.label){case 0:t=(0,u.qu)(q,(0,i.pi)((0,i.pi)({},q),{description:e})),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,(0,h.sZ)(t,q.id)];case 2:return n=a.sent(),G((0,i.pi)((0,i.pi)({},q),{description:n.description})),[3,5];case 3:return r=a.sent(),(0,I.Eo)(r),[3,5];case 4:return H(!1),[7];case 5:return[2]}}))}))}}),m.createElement(r.Z,{"data-testid":"tabs",defaultActiveKey:"policies"},m.createElement($,{key:"policies",tab:x("label.policies")},m.createElement(s.Z,{className:"tw-w-full",direction:"vertical"},m.createElement(l.Z,{title:ne.EditAll?x("label.add-policy"):x("message.no-permission-for-action")},m.createElement(a.Z,{"data-testid":"add-policy",disabled:!ne.EditAll,type:"primary",onClick:function(){return ee({type:A.py.POLICY,selectedData:q.policies||[]})}},x("label.add-policy"))),m.createElement(z,{hasAccess:ne.EditAll,list:null!==(e=q.policies)&&void 0!==e?e:[],type:"policy",onDelete:function(e){return W({record:e,attribute:"policies"})}}))),m.createElement($,{key:"teams",tab:x("label.teams")},m.createElement(z,{hasAccess:ne.EditAll,list:null!==(t=q.teams)&&void 0!==t?t:[],type:"team",onDelete:function(e){return W({record:e,attribute:"teams"})}})),m.createElement($,{key:"users",tab:x("label.users")},m.createElement(z,{hasAccess:ne.EditAll,list:null!==(n=q.users)&&void 0!==n?n:[],type:"user",onDelete:function(e){return W({record:e,attribute:"users"})}}))))):m.createElement(E.Z,null,x("message.no-permission-to-view")),M&&m.createElement(c.Z,{centered:!0,closable:!1,confirmLoading:P,okText:x("label.confirm"),title:x("label.remove-entity",{entity:(0,S.C_)(M.record)})+" "+x("label.from-lowercase")+" "+(0,S.C_)(q),visible:!(0,d.isUndefined)(M.record),onCancel:function(){return W(void 0)},onOk:function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,(t=M.record,n=M.attribute,(0,i.mG)(void 0,void 0,void 0,(function(){var e,r,a,s,l,c,o;return(0,i.Jh)(this,(function(d){switch(d.label){case 0:return K(!0),"teams"!==n?[3,1]:(function(e){(0,i.mG)(void 0,void 0,void 0,(function(){var t,n,r,a,s,l,c;return(0,i.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,4,5]),[4,(0,v.Xv)(e.fullyQualifiedName||"","defaultRoles")];case 1:return t=o.sent(),n=(null!==(l=t.defaultRoles)&&void 0!==l?l:[]).filter((function(e){return e.id!==q.id})),r=(0,u.qu)(t,(0,i.pi)((0,i.pi)({},t),{defaultRoles:n})),[4,(0,v.hh)(t.id,r)];case 2:return o.sent()&&(a=(null!==(c=q.teams)&&void 0!==c?c:[]).filter((function(t){return t.id!==e.id})),G((function(e){return(0,i.pi)((0,i.pi)({},e),{teams:a})}))),[3,5];case 3:return s=o.sent(),(0,I.Eo)(s),[3,5];case 4:return K(!1),[7];case 5:return[2]}}))}))}(t),[3,7]);case 1:return"users"!==n?[3,2]:(function(e){(0,i.mG)(void 0,void 0,void 0,(function(){var t,n,r,a,s,l,c;return(0,i.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,4,5]),[4,(0,b.gs)(e.fullyQualifiedName||"","roles")];case 1:return t=o.sent(),n=(null!==(l=t.roles)&&void 0!==l?l:[]).filter((function(e){return e.id!==q.id})),r=(0,u.qu)(t,(0,i.pi)((0,i.pi)({},t),{roles:n})),[4,(0,b.f_)(t.id,r)];case 2:return o.sent()&&(a=(null!==(c=q.users)&&void 0!==c?c:[]).filter((function(t){return t.id!==e.id})),G((function(e){return(0,i.pi)((0,i.pi)({},e),{users:a})}))),[3,5];case 3:return s=o.sent(),(0,I.Eo)(s),[3,5];case 4:return K(!1),[7];case 5:return[2]}}))}))}(t),[3,7]);case 2:e=null!==(o=q[n])&&void 0!==o?o:[],r=e.filter((function(e){return e.id!==t.id})),a=(0,u.qu)(q,(0,i.pi)((0,i.pi)({},q),((c={})[n]=r,c))),d.label=3;case 3:return d.trys.push([3,5,6,7]),[4,(0,h.sZ)(a,q.id)];case 4:return s=d.sent(),G(s),[3,7];case 5:return l=d.sent(),(0,I.Eo)(l),[3,7];case 6:return K(!1),[7];case 7:return[2]}}))})))];case 1:return e.sent(),W(void 0),[2]}var t,n}))}))}},m.createElement(o.Z.Text,null,x("label.sure-to-remove")," ",(0,S.C_)(M.record)+" "+x("label.from-lowercase")+" "+(0,S.C_)(q)+"?")),j&&m.createElement(R.Z,{isModalLoading:P,isOpen:!(0,d.isUndefined)(j),selectedKeys:j.selectedData.map((function(e){return e.id})),title:x("label.add")+" "+j.type,type:j.type,onCancel:function(){return ee(void 0)},onSave:function(e){return t=e,(0,i.mG)(void 0,void 0,void 0,(function(){var e,n,r,a;return(0,i.Jh)(this,(function(s){switch(s.label){case 0:if(!j)return[3,5];K(!0),e=t.map((function(e){var t=j.selectedData.find((function(t){return t.id===e}));return t||{id:e,type:j.type}})),n=(0,u.qu)(q,(0,i.pi)((0,i.pi)({},q),{policies:e})),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,(0,h.sZ)(n,q.id)];case 2:return r=s.sent(),G(r),ee(void 0),[3,5];case 3:return a=s.sent(),(0,I.Eo)(a),[3,5];case 4:return K(!1),[7];case 5:return[2]}}))}));var t}}))}}}]);