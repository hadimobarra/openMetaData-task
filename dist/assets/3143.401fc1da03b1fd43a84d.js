"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[3143],{73143:function(e,t,n){n.r(t);var i=n(70655),r=n(19650),a=n(96486),o=n(67294),s=n(437),c=n(59293),l=n(32822),u=n(22503),f=n(4318),d=n(28178),m=n(84419),g=n(74380),v=n(14109),p=n(53867),E=n(62761),h=n(96162),w=n(78666),C=n(31968),S=n(28517),R=n(5302),D=n(6929),y=n(48132),Z=n(14731),k=n(96840),b=n(35892),A=n(50168);t.default=function(){var e=(0,c.UO)(),t=e.ingestionType,n=e.serviceFQN,I=e.serviceCategory,P=(0,s.$)().t,N=(0,c.k6)(),x=(0,i.CR)((0,o.useState)(),2),L=x[0],O=x[1],T=(0,i.CR)((0,o.useState)(1),2),z=T[0],Q=T[1],Y=(0,i.CR)((0,o.useState)(!0),2),_=Y[0],G=Y[1],H=(0,i.CR)((0,o.useState)(!1),2),B=H[0],F=H[1],M=(0,i.CR)((0,o.useState)(0),2),V=M[0],$=M[1],q=(0,i.CR)((0,o.useState)(!1),2),J=q[0],U=q[1],W=(0,i.CR)((0,o.useState)(!1),2),X=W[0],j=W[1],K=(0,i.CR)((0,o.useState)(S.g.CREATING),2),ee=K[0],te=K[1],ne=(0,i.CR)((0,o.useState)(""),2),ie=ne[0],re=ne[1],ae=(0,i.CR)((0,o.useState)(!1),2),oe=ae[0],se=ae[1],ce=(0,i.CR)((0,o.useState)([]),2),le=ce[0],ue=ce[1],fe=(0,i.CR)((0,o.useState)(!0),2),de=fe[0],me=fe[1],ge=function(e){return new Promise((function(t){U(!0),$(E.lB),te(S.g.DEPLOYING),(0,l.aw)(null!=e?e:ie).then((function(){j(!0),se(!1),$(E.$M),te(S.g.DEPLOYED)})).catch((function(e){se(!0),te(S.g.DEPLOYING_ERROR),(0,A.Eo)(e||D.Z["api-error-messages"]["deploy-ingestion-error"])})).finally((function(){return t()}))}))},ve=function(){return new Promise((function(e,t){(0,l.x1)().then((function(n){200===n.status?e():t()})).catch((function(){return t()}))}))},pe=function(){N.push((0,E.LE)(n,I,"ingestions"))};return(0,o.useEffect)((function(){ue([{name:(0,a.startCase)(I),url:(0,k.si)(h.CZ.SERVICES,(0,b.tJ)(I))},{name:(null==L?void 0:L.name)||"",url:(0,E.LE)(n,I,"ingestions"),imgSrc:(0,b.zF)((null==L?void 0:L.serviceType)||""),activeTitle:!0},{name:(0,Z.Q)(t,w.Rw.ADD),url:"",activeTitle:!0}])}),[I,t,L]),(0,o.useEffect)((function(){t===R.Hz.Dbt&&Q(2)}),[t]),(0,o.useEffect)((function(){new Promise((function(e){ve().then((function(){me(!0)})).catch((function(){me(!1)})).finally((function(){return e()}))})).finally((function(){(0,u.dO)(I,n).then((function(e){e?O(e):(0,A.Eo)(D.Z["api-error-messages"]["fetch-service-error"])})).catch((function(e){var t;404===(null===(t=e.response)||void 0===t?void 0:t.status)?F(!0):(0,A.Eo)(e,D.Z["api-error-messages"]["fetch-service-error"])})).finally((function(){return G(!1)}))}))}),[I,n]),o.createElement(g.Z,null,_?o.createElement(p.Z,null):B?o.createElement(d.Z,null,(0,y.mW)(I,n)):o.createElement("div",{className:"self-center"},o.createElement(v.Z,{center:!0},o.createElement(r.Z,{direction:"vertical",size:"middle"},o.createElement(m.Z,{titleLinks:le}),o.createElement("div",{className:"form-container"},o.createElement(f.Z,{activeIngestionStep:z,handleCancelClick:pe,handleViewServiceClick:pe,heading:(0,Z.Q)(t,w.Rw.ADD),ingestionAction:ee,ingestionProgress:V,isAirflowSetup:de,isIngestionCreated:J,isIngestionDeployed:X,pipelineType:t,serviceCategory:I,serviceData:L,setActiveIngestionStep:function(e){return Q(e)},showDeployButton:oe,status:C.Y.ADD,onAddIngestionSave:function(e){return $(E.aN),new Promise((function(t,n){return(0,l.XZ)(e).then((function(e){var i;e?(re(null!==(i=e.id)&&void 0!==i?i:""),ge(e.id).finally((function(){return t()}))):((0,A.Eo)(D.Z["api-error-messages"]["create-ingestion-error"]),n())})).catch((function(i){var r;409===(null===(r=i.response)||void 0===r?void 0:r.status)?((0,A.Eo)(i,P("label.entity-already-exists",{entity:"Data asset"})),n()):(0,l.ne)((null==L?void 0:L.name)+"."+e.name).then((function(e){if(!e)throw D.Z["api-error-messages"]["unexpected-server-response"];t(),(0,A.Eo)(i,D.Z["api-error-messages"]["deploy-ingestion-error"])})).catch((function(){(0,A.Eo)(i,D.Z["api-error-messages"]["create-ingestion-error"]),n()}))}))}))},onAirflowStatusCheck:ve,onIngestionDeploy:ge}))),o.createElement("div",{className:"m-t-xlg p-x-lg w-800","data-testid":"right-panel"},(0,b.qx)(z,!0,((null==L?void 0:L.name)||"")+"_"+t,"",t,(t===R.Hz.Metadata?z>=3:z>=2)&&!oe,!1,de)))))}},14731:function(e,t,n){n.d(t,{Q:function(){return o}});var i=n(67800),r=n(78666),a=n(55726),o=function(e,t){var n=(0,i.t)("label."+r.Pm[e]);return e===a.Hz.Dbt&&(n=(0,i.t)("label.dbt-lowercase")),t===r.Rw.ADD?(0,i.t)("label.add-workflow-ingestion",{workflow:n}):(0,i.t)("label.edit-workflow-ingestion",{workflow:n})}}}]);